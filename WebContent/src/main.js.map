{"version":3,"sources":["main.js","../ts/src/App.ts","../ts/src/FitScaleManager.ts","../ts/src/core/Gameplay.ts","../ts/src/scene/Boot.ts","../ts/src/scene/MainScene.ts","../ts/src/scene/Preloader.ts","../ts/src/screen/AreYouSureWindow.ts","../ts/src/screen/CompleteWindow.ts","../ts/src/screen/GameplayScreen.ts","../ts/src/screen/InstructionPage.ts","../ts/src/screen/TryAgainWindow.ts"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","Constructor","protoProps","staticProps","_createForOfIteratorHelper","o","allowArrayLike","it","Array","isArray","_unsupportedIterableToArray","F","s","n","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","step","next","_e2","return","minLen","_arrayLikeToArray","toString","call","slice","name","from","test","arr","len","arr2","_classCallCheck","instance","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","result","Super","_getPrototypeOf","NewTarget","this","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Date","getPrototypeOf","game","ctb","App","_Phaser$Game","Phaser","Game","_super","_this","config","type","AUTO","width","CANVAS_WIDTH","height","CANVAS_HEIGHT","parent","dom","createContainer","scale","mode","FitScaleManager","detectBestScaleMode","autoCenter","Scale","CENTER_BOTH","transparent","scene","add","Boot","window","onload","delayedCalls","delayedCall","delay","callback","args","callbackScope","getAt","dc","time","push","t","setTimeout","pauseAllDelayedCalls","_step","_iterator","Time","TimerEvent","paused","resumeAllDelayedCalls","_step2","_iterator2","destroyAllDelayedCalls","_step3","_iterator3","remove","clearTimeout","destroyDelayedCall","ind","indexOf","splice","setPageBackground","bg","document","querySelector","style","backgroundImage","setupButton","btn","frame","on","setFrame","sound","play","setupButtonTextureBased","texture","hoverTexture","setTexture","parentContainer","playBtnClickAnim","sc","hasOwnProperty","scaleX","scaleY","tweens","targets","duration","yoyo","_this2","doResize","calculateScale","newCanvasWidth","phaserScaleManager","newCanvasHeight","canvasStyle","marginLeft","innerWidth","marginTop","innerHeight","canvas","addListener","Events","RESIZE","onResize","overridePhaserTransformMethods","scaleMode","NONE","Math","min","_this3","transformX","pageX","parseInt","split","transformY","pageY","RESIZE_DELAY","iOS","navigator","platform","isAndroid","userAgent","toLowerCase","FIT","core","Gameplay","allLettersNames","currentRound","correctAnswersCount","wrongAnswersCount","correctAnswersCountThisRound","wrongAnswersCountThisRound","onNewRound","nextLetterDelay","failsNumToLose","Number","cache","json","get","useImages","Boolean","at","wordsLetters","correctWord","onComplete","onLose","totalRoundsNum","score","calculateScore","nextLetter","_this4","fn","thisRound","rounds","shift","blockLetters","onLettersPlaced","getCurrentTotalAnswersCountThisRound","letter","_step4","_iterator4","d","setupCallbacks","letters","_step5","_iterator5","_Phaser$Scene","Scene","_super2","_this5","offsetLeft","parentElement","displayScale","x","offsetTop","y","Preloader","MainScene","_Phaser$Scene2","_super3","gameplay","gameplayScreen","screen","GameplayScreen","children","showInstructionPage","_update","_Phaser$Scene3","_super4","load","_this6","_step6","_iterator6","l","image","_step7","_iterator7","r","_step8","_iterator8","audio","_step9","_iterator9","progressTxt","text","fontFamily","fontSize","color","align","setOrigin","pack","ceil","nextScene","start","animKey","sprite","undefined","mainScene","getScene","anims","exists","data","ANIMS_DATA","frames","generateFrameNames","end","zeroPad","prefix","suffix","frameRate","repeat","currentAnim","off","stop","idle","padNum","atlas","yelling_wrong","AreYouSureWindow","_Phaser$GameObjects$C","GameObjects","Container","_super5","onYes","onNo","_this7","_areYouSurePage","Image","_btnSureYes","setInteractive","cursor","once","_btnSureNo","CompleteWindow","_Phaser$GameObjects$C2","_super6","onBack","onReplay","onNext","_this8","music","setPosition","_bgComplete","_cup","_btnBack","_btnReplay","_btnNext","_CollectedPoints","totalScoreTxt","stroke","strokeThickness","grd","context","createLinearGradient","addColorStop","setFill","starScoreTxt","starScore","ease","Easing","Back","Out","String","_Phaser$GameObjects$C3","_super7","_this9","bgMusic","correctAudio","correctAudioWord","idleDelayedCall","playIdle","character","playAnim","soundWrongDrop","wfsnd","showCompleteWindow","completeWindow","destroyGameplay","destroy","setInputEnabled","show","showLoseWindow","tryAgainWindow","TryAgainWindow","_gameStage","setScale","_btnClose","onCloseClick","_btnSound","onSoundClick","areYouSureWindow","pause","playCorrectAudio","_this10","loop","gameplayContainer","reset","prepareRound","createTallies","_this11","removeAll","longIce","alpha","randomizedLetter","Utils","Shuffle","fixedHeight","setText","selectableLetters","targetBlocks","getCorrectWordLettersNumber","b","getCorrectWordCharAt","a","txt","_step10","_iterator10","_loop","setSize","input","setDraggable","moveBridgeBackToStartPosition","createInput","isNewRound","isRoundsComplete","_step11","_iterator11","addAt","showOut","_this12","pointer","block","dragX","dragY","targetBlock","bringToTop","_step12","_iterator12","abs","checkTargetBlockLetters","pixelPerfect","_step13","_this13","sameLettersNum","_iterator13","Linear","_step14","_iterator14","Sine","onCorrectAnswer","_step15","_iterator15","onWrongAnswer","_step16","_iterator16","playSound","_this14","Distance","Between","placeAppleOverBuckets","getCurrentTotalAnswersCount","tallyEmptyArray","visible","tally","_this15","lost","showAreYouSurePage","_step17","_iterator17","te","_step18","_iterator18","tallyEmptyArrayPositions","_i2","_tallyEmptyArrayPosit","_BeehiveEmpty","_Beehive","_step19","_iterator19","bea","_step20","_iterator20","bee","k","_this16","playInstructionSound","instructionPage","InstructionPage","showGameplay","_this17","pauseAll","pauseSounds","resumeAll","unpauseSounds","enabled","_step21","_iterator21","_step22","_iterator22","disableInteractive","stopAll","_Phaser$GameObjects$C4","_super8","onPlayClick","onSndClick","_this18","_instructionPage","_instructionPageTitle","_btnPlay","instrTxt","setWordWrapWidth","setLineSpacing","_btnSoundInstruction","_Phaser$GameObjects$C5","_super9","_this19","_bg","_star"],"mappings":"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","file":"main.js","sourcesContent":["var ctb;\n(function (ctb) {\n    class App extends Phaser.Game {\n        constructor() {\n            let config = {\n                type: Phaser.AUTO,\n                width: App.CANVAS_WIDTH,\n                height: App.CANVAS_HEIGHT,\n                parent: 'game-container',\n                dom: {\n                    createContainer: false\n                },\n                scale: {\n                    mode: FitScaleManager.detectBestScaleMode(),\n                    autoCenter: Phaser.Scale.CENTER_BOTH\n                },\n                transparent: true,\n                scene: {\n                    create: () => {\n                        this.scene.add('Boot', ctb.scene.Boot, true);\n                    }\n                }\n            };\n            super(config);\n        }\n    }\n    App.CANVAS_WIDTH = 980;\n    App.CANVAS_HEIGHT = 600;\n    ctb.App = App;\n})(ctb || (ctb = {}));\nlet game;\nwindow.onload = () => {\n    game = new ctb.App();\n};\nlet delayedCalls = [];\nfunction delayedCall(delay, callback, args, callbackScope) {\n    let scene = game.scene.getAt(0);\n    if (scene) {\n        let dc = scene.time.delayedCall(delay, callback, args, callbackScope);\n        delayedCalls.push(dc);\n        return dc;\n    }\n    let t = setTimeout(callback, delay);\n    delayedCalls.push(t);\n    return t;\n}\nfunction pauseAllDelayedCalls() {\n    for (let dc of delayedCalls) {\n        if (dc instanceof Phaser.Time.TimerEvent) {\n            dc.paused = true;\n        }\n    }\n}\nfunction resumeAllDelayedCalls() {\n    for (let dc of delayedCalls) {\n        if (dc instanceof Phaser.Time.TimerEvent) {\n            dc.paused = false;\n        }\n    }\n}\nfunction destroyAllDelayedCalls() {\n    for (let dc of delayedCalls) {\n        if (dc instanceof Phaser.Time.TimerEvent) {\n            dc.remove(false);\n        }\n        else {\n            clearTimeout(dc);\n        }\n    }\n    delayedCalls = [];\n}\nfunction destroyDelayedCall(dc) {\n    if (dc instanceof Phaser.Time.TimerEvent) {\n        dc.remove(false);\n    }\n    else {\n        clearTimeout(dc);\n    }\n    let ind = delayedCalls.indexOf(dc);\n    if (ind >= 0)\n        delayedCalls.splice(ind, 1);\n}\nfunction setPageBackground(bg) {\n    document.querySelector(\"html\").style.backgroundImage = \"url(assets/imgs/\" + bg + \".jpg)\";\n}\nfunction setupButton(btn, frame) {\n    btn.on('pointerdown', () => { btn.setFrame(frame + '_hover' + '0000'); });\n    btn.on('pointerover', () => { btn.setFrame(frame + '_hover' + '0000'); game.scene.getAt(0).sound.add(\"button hover\").play(); });\n    btn.on('pointerout', () => { btn.setFrame(frame + '0000'); });\n    btn.on('pointerup', () => { btn.setFrame(frame + '0000'); game.scene.getAt(0).sound.add('activity selection - button selection').play(); });\n}\nfunction setupButtonTextureBased(btn, texture, hoverTexture) {\n    btn.on('pointerdown', () => { btn.setTexture(hoverTexture); });\n    btn.on('pointerover', () => { btn.setTexture(hoverTexture); game.scene.getAt(0).sound.add(\"button hover\").play(); });\n    btn.on('pointerout', () => { btn.setTexture(texture); });\n    btn.on('pointerup', () => { if (btn.parentContainer)\n        btn.setTexture(texture); game.scene.getAt(0).sound.add('activity selection - button selection').play(); });\n}\nfunction playBtnClickAnim(target) {\n    let sc = target.hasOwnProperty(\"defScale\") ? target[\"defScale\"] : 1;\n    target.scaleX = target.scaleY = sc;\n    let scene = game.scene.getAt(0);\n    scene.tweens.add({\n        targets: target,\n        \"scaleX\": 0.9 * sc,\n        \"scaleY\": 0.9 * sc,\n        duration: 100,\n        yoyo: true\n    });\n}\n/**\n * @author Roman Parada\n * This class is created to fix overlapping of bottom part of canvas by navigation bar in iOS.\n * It make a delayed resize of the canvas (like Phaser-3 FIT methods does) and it overrides Phaser-3 input window to Phaser-3 core transform methods\n *\n * How to use:\n * Just call the code line below in Boot scene's init() method of your project:\n * new FitScaleManager(this.game).setup();\n */\nclass FitScaleManager {\n    constructor(game) {\n        this.doResize = () => {\n            let scale = this.calculateScale();\n            let newCanvasWidth = this.phaserScaleManager.width * scale;\n            let newCanvasHeight = this.phaserScaleManager.height * scale;\n            this.canvasStyle.width = newCanvasWidth + 'px';\n            this.canvasStyle.height = newCanvasHeight + 'px';\n            this.canvasStyle.marginLeft = (window.innerWidth - newCanvasWidth) / 2 + 'px';\n            this.canvasStyle.marginTop = (window.innerHeight - newCanvasHeight) / 2 + 'px';\n        };\n        this.game = game;\n        this.canvasStyle = this.game.canvas.style;\n        this.phaserScaleManager = this.game.scale;\n    }\n    static detectBestScaleMode() {\n        let iOS = /iPad|iPhone|iPod/.test(navigator.platform || \"\");\n        let isAndroid = window.navigator.userAgent.toLowerCase().indexOf(\"android\") > -1;\n        return iOS || isAndroid ? Phaser.Scale.FIT : Phaser.Scale.NONE;\n    }\n    ;\n    /**\n     * Just call this method once in Boot scene's init() method\n     */\n    setup() {\n        this.phaserScaleManager.addListener(Phaser.Scale.Events.RESIZE, this.onResize, this);\n        this.overridePhaserTransformMethods();\n        this.onResize();\n    }\n    calculateScale() {\n        if (game.scale.scaleMode == Phaser.Scale.NONE)\n            return 1;\n        return Math.min(window.innerWidth / this.phaserScaleManager.width, window.innerHeight / this.phaserScaleManager.height);\n    }\n    overridePhaserTransformMethods() {\n        this.game.scale.transformX = (pageX) => {\n            return (pageX - parseInt(this.canvasStyle.marginLeft.split(\"px\")[0])) / this.calculateScale();\n        };\n        this.game.scale.transformY = (pageY) => {\n            return (pageY - parseInt(this.canvasStyle.marginTop.split(\"px\")[0])) / this.calculateScale();\n        };\n    }\n    onResize() {\n        setTimeout(this.doResize, FitScaleManager.RESIZE_DELAY);\n    }\n}\nFitScaleManager.RESIZE_DELAY = 500;\nvar ctb;\n(function (ctb) {\n    var core;\n    (function (core) {\n        class Gameplay {\n            constructor() {\n                this.allLettersNames = null;\n                this.currentRound = 0;\n                this.correctAnswersCount = 0;\n                this.wrongAnswersCount = 0;\n                this.correctAnswersCountThisRound = 0;\n                this.wrongAnswersCountThisRound = 0;\n                this.onNewRound = null;\n                this.nextLetterDelay = 0;\n                this.failsNumToLose = Number(game.cache.json.get('gameplay')[\"failsNumToLose\"]);\n                this.useImages = Boolean(game.cache.json.get('gameplay')[\"useImages\"]);\n            }\n            getCorrectWordCharAt(at) {\n                return this.wordsLetters[this.correctWord][at];\n            }\n            getCorrectWordLettersNumber() {\n                return this.wordsLetters[this.correctWord].length;\n            }\n            setupCallbacks(onComplete, onLose, onNewRound) {\n                this.onComplete = onComplete;\n                this.onLose = onLose;\n                this.onNewRound = onNewRound;\n            }\n            calculateScore() {\n                return this.totalRoundsNum - this.wrongAnswersCount;\n            }\n            onLettersPlaced() {\n                if (this.correctAnswersCountThisRound == 1) {\n                    this.currentRound++;\n                    if (this.currentRound >= this.totalRoundsNum) {\n                        let score = this.calculateScore();\n                        this.onComplete(score, score);\n                        return true;\n                    }\n                    else {\n                        this.nextLetter();\n                    }\n                }\n                return false;\n            }\n            nextLetter() {\n                let fn = () => {\n                    let thisRound = this.rounds.shift();\n                    this.blockLetters = thisRound[\"blockLetters\"];\n                    this.correctWord = thisRound[\"correctWord\"];\n                    this.correctAnswersCountThisRound = 0;\n                    this.wrongAnswersCountThisRound = 0;\n                    if (this.onNewRound)\n                        this.onNewRound();\n                };\n                if (this.nextLetterDelay == 0) {\n                    fn();\n                }\n                else {\n                    delayedCall(this.nextLetterDelay, fn);\n                }\n            }\n            onCorrectAnswer() {\n                this.correctAnswersCount++;\n                this.correctAnswersCountThisRound++;\n                this.nextLetterDelay = 3500;\n                return this.onLettersPlaced();\n            }\n            onWrongAnswer() {\n                this.wrongAnswersCount++;\n                this.wrongAnswersCountThisRound++;\n                this.nextLetterDelay = 2000;\n                if (this.wrongAnswersCount >= this.failsNumToLose) {\n                    this.onLose(0, 0);\n                    return true;\n                }\n                else {\n                    this.onLettersPlaced();\n                }\n                return false;\n            }\n            getCurrentTotalAnswersCount() {\n                return this.correctAnswersCount + this.wrongAnswersCount;\n            }\n            getCurrentTotalAnswersCountThisRound() {\n                return this.correctAnswersCountThisRound + this.wrongAnswersCountThisRound;\n            }\n            isNewRound() {\n                return this.getCurrentTotalAnswersCountThisRound() == 0;\n            }\n            isRoundsComplete() {\n                return this.currentRound >= this.totalRoundsNum;\n            }\n            getAudioKeyOfChar(letter) {\n                let json = game.cache.json.get('gameplay');\n                let letters = json[\"letters\"];\n                for (let d of letters) {\n                    if (letter == d['letterName']) {\n                        return d['audioKey'];\n                    }\n                }\n                return null;\n            }\n            reset() {\n                this.nextLetterDelay = 0;\n                this.setupCallbacks(null, null, null);\n                let json = game.cache.json.get('gameplay');\n                this.wordsLetters = json[\"wordsLetters\"];\n                this.rounds = json[\"rounds\"].slice();\n                this.totalRoundsNum = this.rounds.length;\n                this.letters = json[\"letters\"].slice();\n                this.allLettersNames = [];\n                for (let d of this.letters)\n                    this.allLettersNames.push(d[\"letterName\"]);\n                this.nextLetter();\n                this.currentRound = 0;\n                this.correctAnswersCount = 0;\n                this.wrongAnswersCount = 0;\n                this.correctAnswersCountThisRound = 0;\n                this.wrongAnswersCountThisRound = 0;\n            }\n        }\n        core.Gameplay = Gameplay;\n    })(core = ctb.core || (ctb.core = {}));\n})(ctb || (ctb = {}));\nvar ctb;\n(function (ctb) {\n    var scene;\n    (function (scene) {\n        class Boot extends Phaser.Scene {\n            init() {\n                this.game.scale.transformX = (pageX) => {\n                    let offsetLeft = 0;\n                    let parentElement = game.canvas.parentElement;\n                    while (parentElement) {\n                        if (parentElement.offsetLeft) {\n                            offsetLeft = parentElement.offsetLeft;\n                            break;\n                        }\n                        parentElement = parentElement.parentElement;\n                    }\n                    return (pageX - offsetLeft) * this.game.scale.displayScale.x;\n                };\n                this.game.scale.transformY = (pageY) => {\n                    let offsetTop = 0;\n                    let parentElement = game.canvas.parentElement;\n                    while (parentElement) {\n                        if (parentElement.offsetTop) {\n                            offsetTop = parentElement.offsetTop;\n                            break;\n                        }\n                        parentElement = parentElement.parentElement;\n                    }\n                    return (pageY - offsetTop) * this.game.scale.displayScale.y;\n                };\n            }\n            create() {\n                game.scene.remove('Boot');\n                game.scene.add('Preloader', ctb.scene.Preloader, true);\n            }\n        }\n        scene.Boot = Boot;\n    })(scene = ctb.scene || (ctb.scene = {}));\n})(ctb || (ctb = {}));\nvar ctb;\n(function (ctb) {\n    var scene;\n    (function (scene) {\n        var Gameplay = ctb.core.Gameplay;\n        class MainScene extends Phaser.Scene {\n            create() {\n                this.gameplay = new Gameplay();\n                this.gameplayScreen = new ctb.screen.GameplayScreen(this, this.gameplay);\n                this.children.add(this.gameplayScreen);\n                this.gameplayScreen.showInstructionPage();\n            }\n            update() {\n                this.gameplayScreen._update();\n            }\n        }\n        scene.MainScene = MainScene;\n    })(scene = ctb.scene || (ctb.scene = {}));\n})(ctb || (ctb = {}));\nvar ctb;\n(function (ctb) {\n    var scene;\n    (function (scene) {\n        class Preloader extends Phaser.Scene {\n            preload() {\n                this.load.json('gameplay', 'assets/json/gameplay.json');\n            }\n            create() {\n                let json = game.cache.json.get('gameplay');\n                if (json[\"useImages\"]) {\n                    for (let l of json[\"letters\"]) {\n                        this.load.image(l[\"letterName\"], \"assets/imgs/letters/\" + l[\"letterName\"] + \".png\");\n                    }\n                    for (let r of json[\"rounds\"]) {\n                        this.load.image(r[\"correctWord\"], \"assets/imgs/words/\" + r[\"correctWord\"] + \".png\");\n                    }\n                }\n                for (let l of json[\"letters\"]) {\n                    this.load.audio(l[\"audioKey\"], \"assets/sound/mp3/letters/\" + l[\"audioKey\"] + \".mp3\");\n                }\n                for (let r of json[\"rounds\"]) {\n                    this.load.audio(r[\"correctWord\"], \"assets/sound/mp3/words/\" + r[\"correctWord\"] + \".mp3\");\n                }\n                let progressTxt = this.add.text(game.scale.width / 2, game.scale.height / 2, \"\", {\n                    \"fontFamily\": \"Quran Era font\",\n                    \"fontSize\": 25,\n                    \"color\": \"#000000\",\n                    \"align\": 'center'\n                });\n                progressTxt.setOrigin(0.5, 0.5);\n                this.load.pack('preloader', 'assets/pack.json');\n                this.load.on('progress', (value) => {\n                    progressTxt.text = Math.ceil(value * 100) + \"%\";\n                }, this);\n                this.load.on('complete', () => {\n                    this.nextScene();\n                });\n                this.load.start();\n            }\n            static playAnim(animKey, sprite, onComplete = null) {\n                let mainScene = game.scene.getScene('ScreenMain');\n                if (!mainScene.anims.exists(animKey)) {\n                    let data = Preloader.ANIMS_DATA[animKey];\n                    mainScene.anims.create({\n                        key: animKey,\n                        frames: mainScene.anims.generateFrameNames(data['atlas'], {\n                            start: data['start'], end: data['end'], zeroPad: data['padNum'],\n                            prefix: data['prefix'], suffix: ''\n                        }),\n                        frameRate: data['frameRate'],\n                        repeat: data['repeat']\n                    });\n                }\n                if (sprite.anims.currentAnim) {\n                    sprite.off('animationcomplete');\n                }\n                sprite.anims.stop();\n                sprite.play(animKey);\n                sprite.on('animationcomplete', () => {\n                    if (onComplete)\n                        onComplete();\n                });\n                return sprite;\n            }\n            nextScene() {\n                game.scene.remove('Preloader');\n                game.scene.add('ScreenMain', ctb.scene.MainScene, true);\n            }\n        }\n        Preloader.ANIMS_DATA = {\n            'idle': {\n                'start': 0,\n                'end': 51,\n                'padNum': 4,\n                'prefix': 'idle',\n                'repeat': 0,\n                'frameRate': 24,\n                'atlas': 'atlas-shake'\n            },\n            'yelling_wrong': {\n                'start': 0,\n                'end': 46,\n                'padNum': 4,\n                'prefix': 'yelling_wrong',\n                'repeat': 0,\n                'frameRate': 24,\n                'atlas': 'atlas-shake'\n            }\n        };\n        scene.Preloader = Preloader;\n    })(scene = ctb.scene || (ctb.scene = {}));\n})(ctb || (ctb = {}));\nvar ctb;\n(function (ctb) {\n    var screen;\n    (function (screen) {\n        class AreYouSureWindow extends Phaser.GameObjects.Container {\n            constructor(scene, onYes, onNo) {\n                super(scene);\n                this._areYouSurePage = new Phaser.GameObjects.Image(this.scene, -105, 0 - 48, 'Exit warning');\n                this._areYouSurePage.setOrigin(0, 0);\n                // this._areYouSurePage.setInteractive();\n                this._btnSureYes = new Phaser.GameObjects.Image(this.scene, game.scale.width / 2 - 95, 485 - 50, 'btnYES1');\n                this._btnSureYes.setInteractive({ cursor: 'pointer' });\n                this._btnSureYes.once('pointerup', onYes);\n                setupButtonTextureBased(this._btnSureYes, 'btnYES1', 'btnYES2');\n                this._btnSureNo = new Phaser.GameObjects.Image(this.scene, game.scale.width / 2 + 95, 485 - 50, 'btnNO1');\n                this._btnSureNo.setInteractive({ cursor: 'pointer' });\n                this._btnSureNo.once('pointerup', onNo);\n                setupButtonTextureBased(this._btnSureNo, 'btnNO1', 'btnNO2');\n                this.add(this._areYouSurePage);\n                this.add(this._btnSureYes);\n                this.add(this._btnSureNo);\n            }\n        }\n        screen.AreYouSureWindow = AreYouSureWindow;\n    })(screen = ctb.screen || (ctb.screen = {}));\n})(ctb || (ctb = {}));\nvar ctb;\n(function (ctb) {\n    var screen;\n    (function (screen) {\n        class CompleteWindow extends Phaser.GameObjects.Container {\n            constructor(scene, onBack, onReplay, onNext) {\n                super(scene);\n                this.music = null;\n                this.setPosition(-104.5, -48);\n                this._bgComplete = new Phaser.GameObjects.Image(this.scene, 0, 0, 'Completion page LATEST UPDATED');\n                this._bgComplete.setOrigin(0, 0);\n                // this._bgComplete.setInteractive();\n                this._cup = new Phaser.GameObjects.Image(this.scene, 400, 410, 'Trophy');\n                this._btnBack = new Phaser.GameObjects.Image(this.scene, 570, 570, 'btnBACK1');\n                this._btnReplay = new Phaser.GameObjects.Image(this.scene, 720, 570, 'btnReplay1');\n                this._btnNext = new Phaser.GameObjects.Image(this.scene, 870, 570, 'btnNEXT1');\n                let _CollectedPoints = new Phaser.GameObjects.Image(this.scene, 620, 440, 'Collected Points');\n                this.totalScoreTxt = this.scene.add.text(845, 352, \"\", {\n                    \"fontFamily\": \"Kids Rock Demo\",\n                    \"fontSize\": 35,\n                    \"color\": \"#F49F1C\",\n                    \"align\": 'center',\n                    'stroke': '#70451A',\n                    'strokeThickness': 6\n                });\n                this.totalScoreTxt.setOrigin(0.5, 0.5);\n                let grd = this.totalScoreTxt.context.createLinearGradient(0, 0, 0, this.totalScoreTxt.height);\n                grd.addColorStop(0, '#FFFF00');\n                grd.addColorStop(1, '#C17316');\n                this.totalScoreTxt.setFill(grd);\n                this.starScoreTxt = this.scene.add.text(648, 433, \"\", {\n                    \"fontFamily\": \"Kids Rock Demo\",\n                    \"fontSize\": 24,\n                    \"color\": \"#FFFFFF\",\n                    \"align\": 'center'\n                });\n                this.starScoreTxt.setOrigin(0.5, 0.5);\n                this.add([\n                    this._bgComplete,\n                    _CollectedPoints,\n                    this._cup,\n                    this._btnBack,\n                    this._btnReplay,\n                    this._btnNext,\n                    this.totalScoreTxt,\n                    this.starScoreTxt\n                ]);\n                this._btnBack.setInteractive({ cursor: 'pointer' });\n                this._btnBack.on('pointerup', () => {\n                    onBack(this._btnBack);\n                    // if (this.music) {\n                    //     this.music.stop();\n                    // }\n                });\n                setupButtonTextureBased(this._btnBack, 'btnBACK1', 'btnBACK2');\n                this._btnReplay.setInteractive({ cursor: 'pointer' });\n                this._btnReplay.once('pointerup', () => {\n                    onReplay(this._btnReplay);\n                    if (this.music) {\n                        this.music.stop();\n                    }\n                });\n                setupButtonTextureBased(this._btnReplay, 'btnReplay1', 'btnReplay2');\n                this._btnNext.setInteractive({ cursor: 'pointer' });\n                this._btnNext.on('pointerup', () => {\n                    onNext(this._btnNext);\n                    // if (this.music) {\n                    //     this.music.stop();\n                    // }\n                });\n                setupButtonTextureBased(this._btnNext, 'btnNEXT1', 'btnNEXT2');\n            }\n            show(score, starScore) {\n                this._cup.scale = 1.25;\n                this.scene.tweens.add({\n                    targets: this._cup,\n                    \"scale\": 1,\n                    duration: 500,\n                    ease: Phaser.Math.Easing.Back.Out\n                });\n                this.totalScoreTxt.text = String(score);\n                this.starScoreTxt.text = String(starScore);\n                // let music = this.scene.sound.add(\"viktory\");\n                this.music = this.scene.sound.add(\"Activity completion fantastic\");\n                this.music.play();\n            }\n        }\n        screen.CompleteWindow = CompleteWindow;\n    })(screen = ctb.screen || (ctb.screen = {}));\n})(ctb || (ctb = {}));\nvar ctb;\n(function (ctb) {\n    var screen;\n    (function (screen) {\n        var Preloader = ctb.scene.Preloader;\n        class GameplayScreen extends Phaser.GameObjects.Container {\n            constructor(scene, gameplay) {\n                super(scene);\n                this.bgMusic = null;\n                this.correctAudio = null;\n                this.correctAudioWord = null;\n                this.idleDelayedCall = null;\n                this.playIdle = () => {\n                    this.character.setOrigin(0.5, 0.5);\n                    Preloader.playAnim('idle', this.character, () => {\n                        this.idleDelayedCall = delayedCall(5000, () => {\n                            this.playIdle();\n                        });\n                    });\n                };\n                this.soundWrongDrop = null;\n                this.wfsnd = null;\n                this.showCompleteWindow = (score, starScore) => {\n                    let completeWindow = new screen.CompleteWindow(this.scene, (target) => {\n                        playBtnClickAnim(target);\n                    }, (target) => {\n                        playBtnClickAnim(target);\n                        this.destroyGameplay();\n                        completeWindow.destroy(true);\n                        this.showInstructionPage();\n                    }, (target) => {\n                        playBtnClickAnim(target);\n                    });\n                    this.setInputEnabled(false);\n                    delayedCall(2000, () => {\n                        setPageBackground(\"bg-blue\");\n                        this.add(completeWindow);\n                        completeWindow.show(score, starScore);\n                        this.bgMusic.stop();\n                    });\n                };\n                this.showLoseWindow = (score, starScore) => {\n                    let tryAgainWindow = new screen.TryAgainWindow(this.scene, (target) => {\n                        playBtnClickAnim(target);\n                    }, (target) => {\n                        playBtnClickAnim(target);\n                        this.destroyGameplay();\n                        tryAgainWindow.destroy(true);\n                        this.showInstructionPage();\n                    });\n                    this.setInputEnabled(false);\n                    delayedCall(1500, () => {\n                        setPageBackground(\"bg-blue\");\n                        this.add(tryAgainWindow);\n                        tryAgainWindow.show(score, starScore);\n                        this.bgMusic.stop();\n                    });\n                };\n                this.gameplay = gameplay;\n                window[\"gs\"] = this;\n                this._gameStage = new Phaser.GameObjects.Image(this.scene, game.scale.width / 2, game.scale.height / 2, 'BG');\n                this._gameStage.setOrigin(0.5, 0.5);\n                this._gameStage.setScale(1.02);\n                // this._gameStage.setInteractive();\n                this.add(this._gameStage);\n                this._btnClose = new Phaser.GameObjects.Image(this.scene, 1025 - 105, 100 - 50, 'x Button');\n                this._btnClose.setInteractive({ cursor: 'pointer' });\n                this._btnClose[\"defScale\"] = this._btnClose.scale;\n                setupButtonTextureBased(this._btnClose, 'x Button', 'x Button HOVER EFFECT');\n                this.add(this._btnClose);\n                this._btnClose.on('pointerup', () => {\n                    playBtnClickAnim(this._btnClose);\n                    this.onCloseClick();\n                });\n                this._btnSound = new Phaser.GameObjects.Image(this.scene, 160 - 105, 100 - 50, 'Sound');\n                this._btnSound.setInteractive({ cursor: 'pointer' });\n                this._btnSound[\"defScale\"] = this._btnSound.scale;\n                setupButtonTextureBased(this._btnSound, 'Sound', 'Sound HOVER EFFECT');\n                this.add(this._btnSound);\n                this._btnSound.on('pointerup', () => {\n                    playBtnClickAnim(this._btnSound);\n                    this.onSoundClick();\n                });\n            }\n            playCorrectAudio() {\n                if (this.correctAudio) {\n                    this.correctAudio.stop();\n                }\n                this.correctAudio = this.scene.sound.add('Make the word map');\n                this.correctAudio.play();\n                if (this.areYouSureWindow && this.areYouSureWindow.parentContainer == this) {\n                    this.correctAudio.pause();\n                }\n                if (this.correctAudioWord)\n                    this.correctAudioWord.stop();\n            }\n            onSoundClick() {\n                this.playCorrectAudio();\n            }\n            showGameplay() {\n                setPageBackground(\"bg-australia\");\n                this.bgMusic = this.scene.sound.add(\"Winter bg sound\");\n                this.bgMusic.play();\n                this.bgMusic.loop = true;\n                this.gameplayContainer = new Phaser.GameObjects.Container(this.scene);\n                this.add(this.gameplayContainer);\n                this.gameplay.reset();\n                this.prepareRound();\n                this.gameplay.setupCallbacks(this.showCompleteWindow, this.showLoseWindow, () => {\n                    this.onNewRound(true);\n                });\n                this.createTallies();\n            }\n            prepareRound() {\n                delayedCall(500, () => this.playCorrectAudio());\n                this.gameplayContainer.removeAll();\n                this.character = this.scene.add.sprite(0, 0, null);\n                this.character.setPosition(750, 310);\n                this.playIdle();\n                this.longIce = new Phaser.GameObjects.Image(this.scene, 110, 147, 'Long Ice');\n                this.longIce.setOrigin(0, 0);\n                this.longIce.alpha = 0;\n                this.gameplayContainer.add(this.longIce);\n                let randomizedLetter = Phaser.Utils.Array.Shuffle(this.gameplay.blockLetters.slice());\n                if (this.gameplay.useImages) {\n                    let correctWord = new Phaser.GameObjects.Image(this.scene, 750, 180, this.gameplay.correctWord);\n                    this.gameplayContainer.add(correctWord);\n                }\n                else {\n                    let correctWord = this.scene.add.text(750, 180, \"\", {\n                        \"fontFamily\": \"Quran Era font\",\n                        \"fontSize\": 90,\n                        \"color\": \"#000000\",\n                        \"align\": 'center'\n                    });\n                    correctWord.setOrigin(0.5, 0.5);\n                    correctWord.style.fixedHeight = 140;\n                    correctWord.setText(this.gameplay.correctWord);\n                    this.gameplayContainer.add(correctWord);\n                }\n                this.selectableLetters = [];\n                this.targetBlocks = [];\n                for (let i = 0; i < this.gameplay.getCorrectWordLettersNumber(); i++) {\n                    let b = {\n                        x: 174 + i * 133, y: 215\n                    };\n                    b['alreadyFilled'] = false;\n                    this.targetBlocks.push(b);\n                    b[\"-letter-text\"] = this.gameplay.getCorrectWordCharAt(i);\n                    b[\"-block-\"] = null;\n                }\n                for (let i = 0; i < randomizedLetter.length; i++) {\n                    let a = new Phaser.GameObjects.Container(this.scene, 100 + i * 150, 525);\n                    a.add(a[\"-image-\"] = new Phaser.GameObjects.Image(this.scene, 0, 0, 'IceBlock'));\n                    a[\"-image-\"].setOrigin(0.5, 0.5);\n                    this.selectableLetters.push(a);\n                    let txt;\n                    if (this.gameplay.useImages) {\n                        txt = new Phaser.GameObjects.Image(this.scene, 0, 0, randomizedLetter[i]);\n                        a.add(txt);\n                    }\n                    else {\n                        txt = this.scene.add.text(0, 0, \"\", {\n                            \"fontFamily\": \"Quran Era font\",\n                            \"fontSize\": 55,\n                            \"color\": \"#000000\",\n                            \"align\": 'center'\n                        });\n                        txt.setOrigin(0.5, 0.5);\n                        txt.style.fixedHeight = 75;\n                        txt.setText(randomizedLetter[i]);\n                        a.add(txt);\n                    }\n                    a['startPosition'] = { x: a.x, y: a.y };\n                    a[\"-letter-\"] = txt;\n                    a[\"-letter-text\"] = randomizedLetter[i];\n                    this.gameplayContainer.add(a);\n                    a['-draggable-'] = true;\n                }\n                for (let a of this.selectableLetters) {\n                    a.setSize(a[\"-image-\"].width, a[\"-image-\"].height);\n                    a.setInteractive({ cursor: 'pointer' });\n                    this.scene.input.setDraggable(a);\n                    a.on('pointerdown', () => {\n                        a['-pointerdown-'] = true;\n                        if (a['-draggable-'])\n                            this.scene.sound.add(\"drag from its spot\").play();\n                    });\n                    a.on('pointerup', () => {\n                        a['-pointerdown-'] = false;\n                        if (!a['-draggable-'])\n                            return;\n                        this.moveBridgeBackToStartPosition(a, null, true);\n                    });\n                    a.on('pointerout', () => {\n                        if (!a['-draggable-'])\n                            return;\n                        if (!a['-pointerdown-'])\n                            return;\n                        this.moveBridgeBackToStartPosition(a, null, true);\n                    });\n                }\n                this.createInput();\n                this.setInputEnabled(false);\n                // delayedCall(1200, ()=>{\n                if (this.gameplay.isNewRound()) {\n                    if (!this.gameplay.isRoundsComplete()) {\n                        // delayedCall(2000, ()=>{\n                        this.setInputEnabled(true);\n                        // });\n                    }\n                }\n                else {\n                    this.setInputEnabled(true);\n                }\n                // });\n                this.gameplayContainer.add(this.character);\n            }\n            _update() {\n                if (this.selectableLetters) {\n                    for (let a of this.selectableLetters) {\n                        if (a.x < 0 + a[\"-image-\"].width / 2) {\n                            a.x = 0 + a[\"-image-\"].width / 2;\n                        }\n                        else if (a.x > game.scale.width - a[\"-image-\"].width / 2) {\n                            a.x = game.scale.width - a[\"-image-\"].width / 2;\n                        }\n                        if (a.y < 0 + a[\"-image-\"].height / 2) {\n                            a.y = a[\"-image-\"].height / 2;\n                        }\n                        else if (a.y > game.scale.height - a[\"-image-\"].height / 2) {\n                            a.y = game.scale.height - a[\"-image-\"].height / 2;\n                        }\n                    }\n                }\n            }\n            placeAppleOverBuckets(a) {\n                if (!a.parentContainer)\n                    return;\n                this.gameplayContainer.remove(a);\n                this.gameplayContainer.addAt(a, this.gameplayContainer.length);\n            }\n            onNewRound(showOut) {\n                this.scene.sound.add(\"next_round\").play();\n                this.setInputEnabled(false);\n                if (showOut) {\n                    this.prepareRound();\n                }\n            }\n            createInput() {\n                this.scene.input.on('drag', (pointer, block, dragX, dragY) => {\n                    if (!block['-draggable-'])\n                        return;\n                    block.x = dragX;\n                    block.y = dragY;\n                    this.gameplayContainer.bringToTop(block);\n                    let targetBlock;\n                    for (targetBlock of this.targetBlocks) {\n                        if (targetBlock['alreadyFilled'])\n                            continue;\n                        if (Math.abs(block.x - targetBlock.x) < 25 && Math.abs(block.y - targetBlock.y) < 60 && (block.y > targetBlock.y - 7)) {\n                            block['-draggable-'] = false;\n                            targetBlock['alreadyFilled'] = true;\n                            this.scene.tweens.add({\n                                targets: block,\n                                x: targetBlock.x,\n                                y: targetBlock.y,\n                                duration: 300,\n                                ease: Phaser.Math.Easing.Back.Out\n                            });\n                            targetBlock[\"-block-\"] = block;\n                            this.checkTargetBlockLetters();\n                        }\n                    }\n                });\n                this._btnClose.setInteractive({ cursor: 'pointer', pixelPerfect: true });\n            }\n            checkTargetBlockLetters() {\n                let sameLettersNum = 0;\n                for (let targetBlock of this.targetBlocks) {\n                    if (!targetBlock['-block-']) {\n                        this.scene.sound.add(\"Placing block above\").play();\n                        return;\n                    }\n                    if (targetBlock[\"-letter-text\"] == targetBlock['-block-'][\"-letter-text\"]) {\n                        sameLettersNum++;\n                    }\n                }\n                this.setInputEnabled(false);\n                if (sameLettersNum == this.targetBlocks.length) {\n                    this.scene.sound.add(\"Placing block above\").play();\n                    this.scene.tweens.add({\n                        targets: this.longIce,\n                        alpha: 1,\n                        duration: 250,\n                        ease: Phaser.Math.Easing.Linear,\n                    });\n                    for (let targetBlock of this.targetBlocks) {\n                        this.scene.tweens.add({\n                            targets: targetBlock['-block-'][\"-image-\"],\n                            alpha: 0,\n                            duration: 250,\n                            ease: Phaser.Math.Easing.Linear\n                        });\n                        if (targetBlock == this.targetBlocks[1])\n                            continue;\n                        this.scene.tweens.add({\n                            targets: targetBlock['-block-'],\n                            x: this.targetBlocks[1]['x'],\n                            duration: 250,\n                            alpha: 0,\n                            ease: Phaser.Math.Easing.Sine.Out,\n                            delay: 250\n                        });\n                        delayedCall(500, () => {\n                            if (this.gameplay.useImages) {\n                                this.targetBlocks[1]['-block-'][\"-letter-\"].setTexture(this.gameplay.correctWord);\n                            }\n                            else {\n                                this.targetBlocks[1]['-block-'][\"-letter-\"].setText(this.gameplay.correctWord);\n                            }\n                        });\n                    }\n                    this.scene.sound.add(\"Letters joining sound\").play();\n                    delayedCall(250, () => this.scene.sound.add(\"Correct click\").play());\n                    delayedCall(1000, () => this.scene.sound.add(\"success for corect word\").play());\n                    this.onCorrectAnswer();\n                }\n                else {\n                    this.scene.sound.add(\"placed- wrong- snake - blocks go back\").play();\n                    // this.scene.sound.add(\"Wrong attempt\").play();\n                    delayedCall(2400, () => {\n                        for (let targetBlock of this.targetBlocks) {\n                            this.moveBridgeBackToStartPosition(targetBlock['-block-'], null, false);\n                        }\n                        // delayedCall(100, ()=>this.scene.sound.add(\"all three blocks move back after wrong\").play());\n                    });\n                    delayedCall(1500, () => {\n                        this.character.setOrigin(0.49, 0.515);\n                        Preloader.playAnim('yelling_wrong', this.character, () => {\n                            this.playIdle();\n                        });\n                        // this.scene.sound.add(\"Snake animation sfx\").play();\n                    });\n                    delayedCall(2500, () => {\n                        this.onWrongAnswer();\n                        for (let targetBlock of this.targetBlocks) {\n                            targetBlock['alreadyFilled'] = false;\n                            targetBlock['-block-']['-draggable-'] = true;\n                            targetBlock[\"-block-\"] = null;\n                        }\n                    });\n                    delayedCall(2750, () => {\n                        this.setInputEnabled(true);\n                    });\n                }\n            }\n            moveBridgeBackToStartPosition(block, onComplete, playSound) {\n                this.scene.tweens.add({\n                    targets: block,\n                    x: block['startPosition'].x,\n                    y: block['startPosition'].y,\n                    duration: 350,\n                    ease: Phaser.Math.Easing.Sine.Out,\n                    onComplete: () => {\n                        if (onComplete)\n                            onComplete();\n                    }\n                });\n                if (Phaser.Math.Distance.Between(block['startPosition'].x, block['startPosition'].y, block.x, block.y) > 20) {\n                    delayedCall(100, () => {\n                        if (playSound) {\n                            this.scene.sound.add(\"block goes back when released\").play();\n                        }\n                    });\n                }\n                this.placeAppleOverBuckets(block);\n            }\n            onCorrectAnswer() {\n                let i = this.gameplay.getCurrentTotalAnswersCount();\n                this.tallyEmptyArray[i].visible = false;\n                this.tally[i].visible = true;\n                let completed = this.gameplay.onCorrectAnswer();\n                return completed;\n            }\n            onWrongAnswer() {\n                let i = this.gameplay.getCurrentTotalAnswersCount();\n                this.tallyEmptyArray[i].visible = true;\n                this.tallyEmptyArray[i].visible = true;\n                this.tally[i].visible = false;\n                let lost = this.gameplay.onWrongAnswer();\n                // this.soundWrongDrop = this.scene.sound.add(\"wrong drop\");\n                // this.soundWrongDrop.play();\n                // this.scene.sound.add(\"Goose no\").play();\n                if (this.idleDelayedCall != null) {\n                    destroyDelayedCall(this.idleDelayedCall);\n                    this.idleDelayedCall = null;\n                }\n                if (!lost) {\n                    delayedCall(650, () => this.playCorrectAudio());\n                }\n                return lost;\n            }\n            onCloseClick() {\n                this.showAreYouSurePage();\n                this.scene.sound.add('warning page pop up sfx').play();\n            }\n            createTallies() {\n                if (this.tally) {\n                    for (let te of this.tallyEmptyArray) {\n                        te.visible = false;\n                        this.bringToTop(te);\n                    }\n                    for (let t of this.tally) {\n                        t.visible = false;\n                        this.bringToTop(t);\n                    }\n                    return;\n                }\n                let startX = 26;\n                let startY = 148;\n                let dy = 34;\n                let tallyEmptyArrayPositions = [];\n                for (let i = 0; i < 12; i++) {\n                    tallyEmptyArrayPositions.push({ x: startX, y: startY + i * dy });\n                }\n                this.tallyEmptyArray = [];\n                this.tally = [];\n                for (let p of tallyEmptyArrayPositions) {\n                    let _BeehiveEmpty = new Phaser.GameObjects.Image(this.scene, p['x'], p['y'], 'tally Empty');\n                    this.tallyEmptyArray.push(_BeehiveEmpty);\n                    _BeehiveEmpty.visible = false;\n                    let _Beehive = new Phaser.GameObjects.Image(this.scene, p['x'], p['y'], 'tally');\n                    this.tally.push(_Beehive);\n                }\n                for (let bea of this.tallyEmptyArray) {\n                    this.add(bea);\n                }\n                for (let bee of this.tally) {\n                    this.add(bee);\n                    bee.visible = false;\n                }\n            }\n            hideAllUnusedTallies() {\n                let i = this.gameplay.getCurrentTotalAnswersCount();\n                for (let k = i + 1; k < this.tallyEmptyArray.length; k++) {\n                    this.tallyEmptyArray[k].visible = false;\n                    this.tally[k].visible = false;\n                }\n            }\n            showInstructionPage() {\n                setPageBackground(\"bg-blue\");\n                let playInstructionSound = () => {\n                    if (this.wfsnd) {\n                        this.wfsnd.stop();\n                    }\n                    this.wfsnd = this.scene.sound.add(\"Drag the ice blocks to make the word\");\n                    this.wfsnd.play();\n                };\n                this.instructionPage = new screen.InstructionPage(this.scene, (target) => {\n                    playBtnClickAnim(target);\n                    this.instructionPage.destroy(true);\n                    this.showGameplay();\n                    if (this.wfsnd) {\n                        this.wfsnd.stop();\n                    }\n                }, (target) => {\n                    playBtnClickAnim(target);\n                    playInstructionSound();\n                });\n                this.add(this.instructionPage);\n                playInstructionSound();\n            }\n            showAreYouSurePage() {\n                pauseAllDelayedCalls();\n                setPageBackground(\"bg-blue\");\n                this.scene.tweens.pauseAll();\n                this.pauseSounds();\n                this.areYouSureWindow = new screen.AreYouSureWindow(this.scene, () => {\n                    this.scene.tweens.resumeAll();\n                    this.areYouSureWindow.destroy(true);\n                    this.destroyGameplay();\n                    this.showInstructionPage();\n                }, () => {\n                    this.scene.tweens.resumeAll();\n                    this.areYouSureWindow.destroy(true);\n                    this.unpauseSounds();\n                    resumeAllDelayedCalls();\n                    setPageBackground(\"bg-australia\");\n                });\n                this.add(this.areYouSureWindow);\n            }\n            setInputEnabled(enabled) {\n                if (enabled) {\n                    for (let a of this.selectableLetters)\n                        a.setInteractive({ cursor: 'pointer' });\n                }\n                else {\n                    for (let a of this.selectableLetters)\n                        a.disableInteractive();\n                }\n            }\n            pauseSounds() {\n                this.scene.sound.pauseAll();\n            }\n            unpauseSounds() {\n                this.scene.sound.resumeAll();\n            }\n            destroyGameplay() {\n                this.setInputEnabled(false);\n                this.remove(this.gameplayContainer);\n                this.scene.sound.stopAll();\n                destroyAllDelayedCalls();\n            }\n        }\n        screen.GameplayScreen = GameplayScreen;\n    })(screen = ctb.screen || (ctb.screen = {}));\n})(ctb || (ctb = {}));\nvar ctb;\n(function (ctb) {\n    var screen;\n    (function (screen) {\n        class InstructionPage extends Phaser.GameObjects.Container {\n            constructor(scene, onPlayClick, onSndClick) {\n                super(scene);\n                this._instructionPage = new Phaser.GameObjects.Image(this.scene, 0 - 105, 0 - 48, 'Instructions page  ALL ACTIVITY  TITLEs');\n                this._instructionPage.setOrigin(0, 0);\n                // this._instructionPage.setInteractive();\n                this._instructionPageTitle = new Phaser.GameObjects.Image(this.scene, 495, 105, 'Ice Blocks');\n                this._instructionPageTitle.setScale(0.75);\n                this._btnPlay = new Phaser.GameObjects.Image(this.scene, game.scale.width / 2, 480 - 50, 'btnPLAY1');\n                this._btnPlay.setInteractive({ cursor: 'pointer' });\n                this._btnPlay.once('pointerup', onPlayClick);\n                setupButtonTextureBased(this._btnPlay, 'btnPLAY1', 'btnPLAY2');\n                this.instrTxt = this.scene.add.text(game.scale.width / 2, game.scale.height / 2, \"Drag the ice blocks to make the word.\", {\n                    \"fontFamily\": \"Kids Rock Demo\",\n                    \"fontSize\": 30,\n                    \"color\": \"#43425D\",\n                    \"align\": 'center'\n                });\n                this.instrTxt.setOrigin(0.5, 0.5);\n                this.instrTxt.setWordWrapWidth(600);\n                this.instrTxt.setLineSpacing(5);\n                this._btnSoundInstruction = new Phaser.GameObjects.Image(this.scene, 800 - 105, 156 - 50, 'Sound');\n                this._btnSoundInstruction.setInteractive({ cursor: 'pointer' });\n                this._btnSoundInstruction.on('pointerup', onSndClick);\n                this._btnSoundInstruction[\"defScale\"] = this._btnSoundInstruction.scale;\n                setupButtonTextureBased(this._btnSoundInstruction, 'Sound', 'Sound HOVER EFFECT');\n                this.add(this._instructionPage);\n                this.add(this._instructionPageTitle);\n                this.add(this.instrTxt);\n                this.add(this._btnPlay);\n                this.add(this._btnSoundInstruction);\n            }\n        }\n        screen.InstructionPage = InstructionPage;\n    })(screen = ctb.screen || (ctb.screen = {}));\n})(ctb || (ctb = {}));\nvar ctb;\n(function (ctb) {\n    var screen;\n    (function (screen) {\n        class TryAgainWindow extends Phaser.GameObjects.Container {\n            constructor(scene, onBack, onReplay) {\n                super(scene);\n                this.music = null;\n                this.setPosition(-106, -48);\n                this._bg = new Phaser.GameObjects.Image(this.scene, 0, 0, 'Try again page');\n                this._bg.setOrigin(0, 0);\n                // this._bg.setInteractive();\n                this._star = new Phaser.GameObjects.Image(this.scene, 400, 415, 'Break Star');\n                this._btnBack = new Phaser.GameObjects.Image(this.scene, 600, 580, 'btnBACK1');\n                this._btnReplay = new Phaser.GameObjects.Image(this.scene, 765, 580, 'btnReplay1');\n                this.totalScoreTxt = this.scene.add.text(830, 355, \"\", {\n                    \"fontFamily\": \"Kids Rock Demo\",\n                    \"fontSize\": 35,\n                    \"color\": \"#F49F1C\",\n                    \"align\": 'center',\n                    'stroke': '#70451A',\n                    'strokeThickness': 6\n                });\n                this.totalScoreTxt.setOrigin(0.5, 0.5);\n                let grd = this.totalScoreTxt.context.createLinearGradient(0, 0, 0, this.totalScoreTxt.height);\n                grd.addColorStop(0, '#FFFF00');\n                grd.addColorStop(1, '#C17316');\n                this.totalScoreTxt.setFill(grd);\n                this.starScoreTxt = this.scene.add.text(635, 431, \"\", {\n                    \"fontFamily\": \"Kids Rock Demo\",\n                    \"fontSize\": 24,\n                    \"color\": \"#FFFFFF\",\n                    \"align\": 'center'\n                });\n                this.starScoreTxt.setOrigin(0.5, 0.5);\n                this.add([\n                    this._bg,\n                    this._star,\n                    this._btnBack,\n                    this._btnReplay,\n                    this.totalScoreTxt,\n                    this.starScoreTxt\n                ]);\n                this._btnBack.setInteractive({ cursor: 'pointer' });\n                this._btnBack.on('pointerup', () => {\n                    onBack(this._btnBack);\n                    // if (this.music) {\n                    //     this.music.stop();\n                    // }\n                });\n                setupButtonTextureBased(this._btnBack, 'btnBACK1', 'btnBACK2');\n                this._btnReplay.setInteractive({ cursor: 'pointer' });\n                this._btnReplay.once('pointerup', () => {\n                    onReplay(this._btnReplay);\n                    if (this.music) {\n                        this.music.stop();\n                    }\n                });\n                setupButtonTextureBased(this._btnReplay, 'btnReplay1', 'btnReplay2');\n            }\n            show(score, starScore) {\n                this._star.scale = 1.25;\n                this.scene.tweens.add({\n                    targets: this._star,\n                    \"scale\": 1,\n                    duration: 500,\n                    ease: Phaser.Math.Easing.Back.Out\n                });\n                this.totalScoreTxt.text = String(score);\n                this.starScoreTxt.text = String(starScore);\n                this.music = this.scene.sound.add(\"Fail - close one\");\n                this.music.play();\n            }\n        }\n        screen.TryAgainWindow = TryAgainWindow;\n    })(screen = ctb.screen || (ctb.screen = {}));\n})(ctb || (ctb = {}));\n","namespace ctb {\r\n    export class App extends Phaser.Game {\r\n\r\n        public static readonly CANVAS_WIDTH: number = 980;\r\n        public static readonly CANVAS_HEIGHT: number = 600;\r\n\r\n        constructor() {\r\n            let config: Phaser.Types.Core.GameConfig = {\r\n                type: Phaser.AUTO,\r\n                width: App.CANVAS_WIDTH,\r\n                height: App.CANVAS_HEIGHT,\r\n                parent: 'game-container',\r\n                dom: {\r\n                    createContainer: false\r\n                },\r\n                scale: {\r\n                    mode: FitScaleManager.detectBestScaleMode(),\r\n                    autoCenter: Phaser.Scale.CENTER_BOTH\r\n                },\r\n                transparent: true,\r\n                scene: {\r\n                    create: () => {\r\n                        this.scene.add('Boot', ctb.scene.Boot, true);\r\n                    }\r\n                }\r\n            };\r\n            super(config);\r\n        }\r\n    }\r\n}\r\n\r\nlet game: ctb.App;\r\nwindow.onload = () => {\r\n    game = new ctb.App();\r\n};\r\n\r\nlet delayedCalls = [];\r\nfunction delayedCall(delay: number, callback: Function, args?: any[], callbackScope?: any): Phaser.Time.TimerEvent | number {\r\n    let scene = game.scene.getAt(0);\r\n    if (scene) {\r\n        let dc = scene.time.delayedCall(delay, callback, args, callbackScope);\r\n        delayedCalls.push(dc);\r\n        return dc;\r\n    }\r\n    let t = setTimeout(callback, delay);\r\n    delayedCalls.push(t);\r\n    return t;\r\n}\r\nfunction pauseAllDelayedCalls() {\r\n    for (let dc of delayedCalls) {\r\n        if (dc instanceof Phaser.Time.TimerEvent) {\r\n            (dc as Phaser.Time.TimerEvent).paused = true;\r\n        }\r\n    }\r\n}\r\nfunction resumeAllDelayedCalls() {\r\n    for (let dc of delayedCalls) {\r\n        if (dc instanceof Phaser.Time.TimerEvent) {\r\n            (dc as Phaser.Time.TimerEvent).paused = false;\r\n        }\r\n    }\r\n}\r\nfunction destroyAllDelayedCalls() {\r\n    for (let dc of delayedCalls) {\r\n        if (dc instanceof Phaser.Time.TimerEvent) {\r\n            (dc as Phaser.Time.TimerEvent).remove(false);\r\n        } else {\r\n            clearTimeout(dc);\r\n        }\r\n    }\r\n    delayedCalls = [];\r\n}\r\nfunction destroyDelayedCall(dc) {\r\n    if (dc instanceof Phaser.Time.TimerEvent) {\r\n        (dc as Phaser.Time.TimerEvent).remove(false);\r\n    } else {\r\n        clearTimeout(dc);\r\n    }\r\n    let ind = delayedCalls.indexOf(dc);\r\n    if (ind >= 0) delayedCalls.splice(ind, 1);\r\n}\r\n\r\nfunction setPageBackground(bg: string) {\r\n    document.querySelector(\"html\").style.backgroundImage = \"url(assets/imgs/\" + bg + \".jpg)\";\r\n}\r\n\r\nfunction setupButton(btn, frame) {\r\n    btn.on('pointerdown', ()=>{btn.setFrame(frame + '_hover' + '0000')});\r\n    btn.on('pointerover', ()=>{btn.setFrame(frame + '_hover' + '0000');game.scene.getAt(0).sound.add(\"button hover\").play();});\r\n    btn.on('pointerout', ()=>{btn.setFrame(frame + '0000')});\r\n    btn.on('pointerup', ()=>{btn.setFrame(frame + '0000');game.scene.getAt(0).sound.add('activity selection - button selection').play();});\r\n}\r\nfunction setupButtonTextureBased(btn:Phaser.GameObjects.Image, texture, hoverTexture) {\r\n    btn.on('pointerdown', ()=>{btn.setTexture(hoverTexture)});\r\n    btn.on('pointerover', ()=>{btn.setTexture(hoverTexture);game.scene.getAt(0).sound.add(\"button hover\").play();});\r\n    btn.on('pointerout', ()=>{btn.setTexture(texture)});\r\n    btn.on('pointerup', ()=>{if (btn.parentContainer)btn.setTexture(texture);game.scene.getAt(0).sound.add('activity selection - button selection').play();});\r\n}\r\n\r\n\r\n\r\nfunction playBtnClickAnim(target): void {\r\n    let sc:number = target.hasOwnProperty(\"defScale\") ? target[\"defScale\"] : 1;\r\n    target.scaleX = target.scaleY = sc;\r\n    let scene = game.scene.getAt(0);\r\n    scene.tweens.add({\r\n        targets: target,\r\n        \"scaleX\": 0.9 * sc,\r\n        \"scaleY\": 0.9 * sc,\r\n        duration: 100,\r\n        yoyo: true\r\n    });\r\n}","/**\r\n * @author Roman Parada\r\n * This class is created to fix overlapping of bottom part of canvas by navigation bar in iOS.\r\n * It make a delayed resize of the canvas (like Phaser-3 FIT methods does) and it overrides Phaser-3 input window to Phaser-3 core transform methods\r\n *\r\n * How to use:\r\n * Just call the code line below in Boot scene's init() method of your project:\r\n * new FitScaleManager(this.game).setup();\r\n */\r\nclass FitScaleManager {\r\n\r\n    public static detectBestScaleMode():integer {\r\n        let iOS = /iPad|iPhone|iPod/.test(navigator.platform || \"\");\r\n        let isAndroid = window.navigator.userAgent.toLowerCase().indexOf(\"android\") > -1;\r\n        return iOS || isAndroid ? Phaser.Scale.FIT : Phaser.Scale.NONE;\r\n    };\r\n\r\n    private static RESIZE_DELAY: number = 500;\r\n\r\n    private game: Phaser.Game;\r\n\r\n    private canvasStyle: CSSStyleDeclaration;\r\n    private phaserScaleManager: Phaser.Scale.ScaleManager;\r\n\r\n    constructor(game: Phaser.Game) {\r\n        this.game = game;\r\n\r\n        this.canvasStyle = this.game.canvas.style;\r\n        this.phaserScaleManager = this.game.scale;\r\n    }\r\n\r\n    /**\r\n     * Just call this method once in Boot scene's init() method\r\n     */\r\n    public setup(): void {\r\n        this.phaserScaleManager.addListener(Phaser.Scale.Events.RESIZE, this.onResize, this);\r\n\r\n        this.overridePhaserTransformMethods();\r\n\r\n        this.onResize();\r\n    }\r\n\r\n    private calculateScale(): number {\r\n        if (game.scale.scaleMode == Phaser.Scale.NONE) return 1;\r\n\r\n        return Math.min(\r\n            window.innerWidth / this.phaserScaleManager.width,\r\n            window.innerHeight / this.phaserScaleManager.height\r\n        );\r\n    }\r\n\r\n    private overridePhaserTransformMethods(): void {\r\n        this.game.scale.transformX = (pageX: number) => {\r\n            return (pageX - parseInt(this.canvasStyle.marginLeft.split(\"px\")[0])) / this.calculateScale();\r\n        };\r\n        this.game.scale.transformY = (pageY: number) => {\r\n            return (pageY - parseInt(this.canvasStyle.marginTop.split(\"px\")[0])) / this.calculateScale();\r\n        };\r\n    }\r\n\r\n    private onResize(): void {\r\n        setTimeout(this.doResize, FitScaleManager.RESIZE_DELAY);\r\n    }\r\n\r\n    private doResize: () => void = () => {\r\n        let scale: number = this.calculateScale();\r\n\r\n        let newCanvasWidth: number = this.phaserScaleManager.width * scale;\r\n        let newCanvasHeight: number = this.phaserScaleManager.height * scale;\r\n\r\n        this.canvasStyle.width = newCanvasWidth + 'px';\r\n        this.canvasStyle.height = newCanvasHeight + 'px';\r\n\r\n        this.canvasStyle.marginLeft = (window.innerWidth - newCanvasWidth) / 2 + 'px';\r\n        this.canvasStyle.marginTop = (window.innerHeight - newCanvasHeight) / 2 + 'px';\r\n    };\r\n}","namespace ctb.core {\r\n    export class Gameplay {\r\n        public allLettersNames:string[] = null;\r\n\r\n        public totalRoundsNum:number;\r\n        public readonly failsNumToLose:number;\r\n\r\n        private currentRound:number = 0;\r\n        private letters:object[];\r\n        private rounds:object[];\r\n        public blockLetters:string[];\r\n        public correctWord:string;\r\n\r\n        private correctAnswersCount: number = 0;\r\n        private wrongAnswersCount: number = 0;\r\n        public correctAnswersCountThisRound: number = 0;\r\n        public wrongAnswersCountThisRound: number = 0;\r\n\r\n        private onComplete:(score:number, starScore:number)=>void;\r\n        private onLose:(score:number, starScore:number)=>void;\r\n        private onNewRound:()=>void = null;\r\n\r\n        public useImages:boolean;\r\n\r\n        private wordsLetters:object;\r\n        public getCorrectWordCharAt(at:number):string {\r\n            return this.wordsLetters[this.correctWord][at];\r\n        }\r\n        public getCorrectWordLettersNumber():number {\r\n            return this.wordsLetters[this.correctWord].length;\r\n        }\r\n\r\n        constructor() {\r\n            this.failsNumToLose = Number(game.cache.json.get('gameplay')[\"failsNumToLose\"]);\r\n            this.useImages = Boolean(game.cache.json.get('gameplay')[\"useImages\"]);\r\n        }\r\n\r\n        public setupCallbacks(onComplete:(score:number, starScore:number)=>void, onLose:(score:number, starScore:number)=>void, onNewRound:()=>void):void {\r\n            this.onComplete = onComplete;\r\n            this.onLose = onLose;\r\n            this.onNewRound = onNewRound;\r\n        }\r\n\r\n        public calculateScore():number {\r\n            return this.totalRoundsNum - this.wrongAnswersCount;\r\n        }\r\n\r\n        public onLettersPlaced():boolean {\r\n            if (this.correctAnswersCountThisRound == 1) {\r\n                this.currentRound++;\r\n                if (this.currentRound >= this.totalRoundsNum) {\r\n                    let score:number = this.calculateScore();\r\n                    this.onComplete(score, score);\r\n                    return true;\r\n                } else {\r\n                    this.nextLetter();\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n\r\n        public nextLetterDelay:number = 0;\r\n        public nextLetter():void {\r\n            let fn:()=>void = ()=>{\r\n                let thisRound = this.rounds.shift();\r\n                this.blockLetters = thisRound[\"blockLetters\"];\r\n                this.correctWord = thisRound[\"correctWord\"];\r\n\r\n                this.correctAnswersCountThisRound = 0;\r\n                this.wrongAnswersCountThisRound = 0;\r\n\r\n                if (this.onNewRound) this.onNewRound();\r\n            };\r\n            if (this.nextLetterDelay == 0) {\r\n                fn();\r\n            } else {\r\n                delayedCall(this.nextLetterDelay, fn);\r\n            }\r\n        }\r\n\r\n        public onCorrectAnswer(): boolean {\r\n            this.correctAnswersCount++;\r\n            this.correctAnswersCountThisRound++;\r\n\r\n            this.nextLetterDelay = 3500;\r\n\r\n            return this.onLettersPlaced();\r\n        }\r\n\r\n        public onWrongAnswer(): boolean {\r\n            this.wrongAnswersCount++;\r\n            this.wrongAnswersCountThisRound++;\r\n\r\n            this.nextLetterDelay = 2000;\r\n\r\n            if (this.wrongAnswersCount >= this.failsNumToLose) {\r\n                this.onLose(0, 0);\r\n                return true;\r\n            } else {\r\n                this.onLettersPlaced();\r\n            }\r\n            return false;\r\n        }\r\n\r\n        public getCurrentTotalAnswersCount(): number {\r\n            return this.correctAnswersCount + this.wrongAnswersCount;\r\n        }\r\n\r\n        public getCurrentTotalAnswersCountThisRound(): number {\r\n            return this.correctAnswersCountThisRound + this.wrongAnswersCountThisRound;\r\n        }\r\n\r\n        public isNewRound():boolean {\r\n            return this.getCurrentTotalAnswersCountThisRound() == 0;\r\n        }\r\n\r\n        public isRoundsComplete():boolean {\r\n            return this.currentRound >= this.totalRoundsNum;\r\n        }\r\n\r\n        public getAudioKeyOfChar(letter:string):string {\r\n            let json = game.cache.json.get('gameplay');\r\n            let letters = json[\"letters\"];\r\n            for (let d of letters) {\r\n                if (letter == d['letterName']) {\r\n                    return d['audioKey'];\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n\r\n        public reset():void {\r\n            this.nextLetterDelay = 0;\r\n            this.setupCallbacks(null, null, null);\r\n\r\n            let json = game.cache.json.get('gameplay');\r\n            this.wordsLetters = json[\"wordsLetters\"];\r\n            this.rounds = json[\"rounds\"].slice();\r\n            this.totalRoundsNum = this.rounds.length;\r\n            this.letters = json[\"letters\"].slice();\r\n            this.allLettersNames = [];\r\n            for (let d of this.letters) this.allLettersNames.push(d[\"letterName\"]);\r\n\r\n            this.nextLetter();\r\n\r\n            this.currentRound = 0;\r\n            this.correctAnswersCount = 0;\r\n            this.wrongAnswersCount = 0;\r\n            this.correctAnswersCountThisRound = 0;\r\n            this.wrongAnswersCountThisRound = 0;\r\n        }\r\n    }\r\n}","module ctb.scene {\r\n    export class Boot extends Phaser.Scene {\r\n        init() {\r\n            this.game.scale.transformX = (pageX: number) => {\r\n                let offsetLeft: number = 0;\r\n                let parentElement = game.canvas.parentElement;\r\n                while (parentElement) {\r\n                    if (parentElement.offsetLeft) {\r\n                        offsetLeft = parentElement.offsetLeft;\r\n                        break;\r\n                    }\r\n                    parentElement = parentElement.parentElement;\r\n                }\r\n                return (pageX - offsetLeft) * this.game.scale.displayScale.x;\r\n            };\r\n            this.game.scale.transformY = (pageY: number) => {\r\n                let offsetTop: number = 0;\r\n                let parentElement = game.canvas.parentElement;\r\n                while (parentElement) {\r\n                    if (parentElement.offsetTop) {\r\n                        offsetTop = parentElement.offsetTop;\r\n                        break;\r\n                    }\r\n                    parentElement = parentElement.parentElement;\r\n                }\r\n                return (pageY - offsetTop) * this.game.scale.displayScale.y;\r\n            };\r\n        }\r\n\r\n        create() {\r\n            game.scene.remove('Boot');\r\n            game.scene.add('Preloader', ctb.scene.Preloader, true);\r\n        }\r\n    }\r\n}","namespace ctb.scene {\r\n\r\n    import Gameplay = ctb.core.Gameplay;\r\n    import GameplayScreen = ctb.screen.GameplayScreen;\r\n\r\n    export class MainScene extends Phaser.Scene {\r\n\r\n        private gameplay:Gameplay;\r\n        private gameplayScreen:GameplayScreen;\r\n\r\n        public create():void {\r\n            this.gameplay = new Gameplay();\r\n\r\n            this.gameplayScreen = new ctb.screen.GameplayScreen(this, this.gameplay);\r\n            this.children.add(this.gameplayScreen);\r\n            this.gameplayScreen.showInstructionPage();\r\n        }\r\n\r\n        public update(): void {\r\n            this.gameplayScreen._update();\r\n        }\r\n    }\r\n}","module ctb.scene {\r\n\r\n    export class Preloader extends Phaser.Scene {\r\n\r\n        public static readonly ANIMS_DATA:object = {\r\n            'idle': {\r\n                'start': 0,\r\n                'end': 51,\r\n                'padNum': 4,\r\n                'prefix': 'idle',\r\n                'repeat': 0,\r\n                'frameRate': 24,\r\n                'atlas': 'atlas-shake'\r\n            },\r\n            'yelling_wrong': {\r\n                'start': 0,\r\n                'end': 46,\r\n                'padNum': 4,\r\n                'prefix': 'yelling_wrong',\r\n                'repeat': 0,\r\n                'frameRate': 24,\r\n                'atlas': 'atlas-shake'\r\n            }\r\n        };\r\n\r\n        preload() {\r\n            this.load.json('gameplay', 'assets/json/gameplay.json');\r\n        }\r\n\r\n        create() {\r\n            let json = game.cache.json.get('gameplay');\r\n            if (json[\"useImages\"]) {\r\n                for (let l of json[\"letters\"]) {\r\n                    this.load.image(l[\"letterName\"], \"assets/imgs/letters/\"+l[\"letterName\"]+\".png\");\r\n                }\r\n                for (let r of json[\"rounds\"]) {\r\n                    this.load.image(r[\"correctWord\"], \"assets/imgs/words/\"+r[\"correctWord\"]+\".png\");\r\n                }\r\n            }\r\n            for (let l of json[\"letters\"]) {\r\n                this.load.audio(l[\"audioKey\"], \"assets/sound/mp3/letters/\"+l[\"audioKey\"]+\".mp3\");\r\n            }\r\n            for (let r of json[\"rounds\"]) {\r\n                this.load.audio(r[\"correctWord\"], \"assets/sound/mp3/words/\"+r[\"correctWord\"]+\".mp3\");\r\n            }\r\n\r\n            let progressTxt:Phaser.GameObjects.Text = this.add.text(game.scale.width/2, game.scale.height/2, \"\", {\r\n                \"fontFamily\": \"Quran Era font\",\r\n                \"fontSize\": 25,\r\n                \"color\": \"#000000\",\r\n                \"align\": 'center'\r\n            });\r\n            progressTxt.setOrigin(0.5, 0.5);\r\n\r\n            this.load.pack('preloader', 'assets/pack.json');\r\n\r\n            this.load.on('progress', (value:number) => {\r\n                progressTxt.text = Math.ceil(value * 100) + \"%\";\r\n            }, this);\r\n\r\n            this.load.on('complete', () => {\r\n                this.nextScene();\r\n            });\r\n\r\n            this.load.start();\r\n        }\r\n\r\n        public static playAnim(animKey:string, sprite:Phaser.GameObjects.Sprite, onComplete:()=>void = null):Phaser.GameObjects.Sprite {\r\n            let mainScene = game.scene.getScene('ScreenMain');\r\n            if (!mainScene.anims.exists(animKey)) {\r\n                let data = Preloader.ANIMS_DATA[animKey];\r\n                mainScene.anims.create({\r\n                    key: animKey,\r\n                    frames: mainScene.anims.generateFrameNames(data['atlas'], {\r\n                        start: data['start'], end: data['end'], zeroPad: data['padNum'],\r\n                        prefix: data['prefix'], suffix: ''\r\n                    }),\r\n                    frameRate: data['frameRate'],\r\n                    repeat: data['repeat']\r\n                });\r\n            }\r\n            if (sprite.anims.currentAnim) {\r\n                sprite.off('animationcomplete');\r\n            }\r\n            sprite.anims.stop();\r\n            sprite.play(animKey);\r\n            sprite.on('animationcomplete', ()=>{\r\n                if (onComplete) onComplete();\r\n            });\r\n            return sprite;\r\n        }\r\n\r\n        private nextScene():void {\r\n            game.scene.remove('Preloader');\r\n            game.scene.add('ScreenMain', ctb.scene.MainScene, true);\r\n        }\r\n    }\r\n}","namespace ctb.screen {\r\n    export class AreYouSureWindow extends Phaser.GameObjects.Container {\r\n\r\n        private _areYouSurePage: Phaser.GameObjects.Image;\r\n        private _btnSureYes: Phaser.GameObjects.Image;\r\n        private _btnSureNo: Phaser.GameObjects.Image;\r\n\r\n        constructor(scene: Phaser.Scene, onYes:()=>void, onNo:()=>void) {\r\n            super(scene);\r\n\r\n            this._areYouSurePage = new Phaser.GameObjects.Image(this.scene, -105, 0-48, 'Exit warning');\r\n            this._areYouSurePage.setOrigin(0, 0);\r\n            // this._areYouSurePage.setInteractive();\r\n\r\n            this._btnSureYes = new Phaser.GameObjects.Image(this.scene, game.scale.width / 2 - 95, 485-50, 'btnYES1');\r\n            this._btnSureYes.setInteractive({cursor: 'pointer'});\r\n            this._btnSureYes.once('pointerup', onYes);\r\n            setupButtonTextureBased(this._btnSureYes, 'btnYES1', 'btnYES2');\r\n\r\n            this._btnSureNo = new Phaser.GameObjects.Image(this.scene, game.scale.width / 2 + 95, 485-50, 'btnNO1');\r\n            this._btnSureNo.setInteractive({cursor: 'pointer'});\r\n            this._btnSureNo.once('pointerup', onNo);\r\n            setupButtonTextureBased(this._btnSureNo, 'btnNO1', 'btnNO2');\r\n\r\n            this.add(this._areYouSurePage);\r\n            this.add(this._btnSureYes);\r\n            this.add(this._btnSureNo);\r\n        }\r\n    }\r\n}","namespace ctb.screen {\r\n    export class CompleteWindow extends Phaser.GameObjects.Container {\r\n\r\n        _bgComplete:Phaser.GameObjects.Image;\r\n        _cup:Phaser.GameObjects.Image;\r\n        _btnBack:Phaser.GameObjects.Image;\r\n        _btnReplay:Phaser.GameObjects.Image;\r\n        _btnNext:Phaser.GameObjects.Image;\r\n\r\n        totalScoreTxt:Phaser.GameObjects.Text;\r\n        starScoreTxt:Phaser.GameObjects.Text;\r\n\r\n        constructor(scene: Phaser.Scene, onBack:(target)=>void, onReplay:(target)=>void, onNext:(target)=>void) {\r\n            super(scene);\r\n\r\n            this.setPosition(-104.5, -48);\r\n\r\n            this._bgComplete = new Phaser.GameObjects.Image(this.scene, 0, 0, 'Completion page LATEST UPDATED');\r\n            this._bgComplete.setOrigin(0, 0);\r\n            // this._bgComplete.setInteractive();\r\n            this._cup = new Phaser.GameObjects.Image(this.scene, 400, 410, 'Trophy');\r\n            this._btnBack = new Phaser.GameObjects.Image(this.scene, 570, 570, 'btnBACK1');\r\n            this._btnReplay = new Phaser.GameObjects.Image(this.scene, 720, 570, 'btnReplay1');\r\n            this._btnNext = new Phaser.GameObjects.Image(this.scene, 870, 570, 'btnNEXT1');\r\n\r\n            let _CollectedPoints = new Phaser.GameObjects.Image(this.scene, 620, 440, 'Collected Points');\r\n\r\n            this.totalScoreTxt = this.scene.add.text(845, 352, \"\", {\r\n                \"fontFamily\": \"Kids Rock Demo\",\r\n                \"fontSize\": 35,\r\n                \"color\": \"#F49F1C\",\r\n                \"align\": 'center',\r\n                'stroke': '#70451A',\r\n                'strokeThickness': 6\r\n            });\r\n            this.totalScoreTxt.setOrigin(0.5, 0.5);\r\n\r\n            let grd = this.totalScoreTxt.context.createLinearGradient(0, 0, 0, this.totalScoreTxt.height);\r\n            grd.addColorStop(0, '#FFFF00');\r\n            grd.addColorStop(1, '#C17316');\r\n            this.totalScoreTxt.setFill(grd);\r\n\r\n            this.starScoreTxt = this.scene.add.text(648, 433, \"\", {\r\n                \"fontFamily\": \"Kids Rock Demo\",\r\n                \"fontSize\": 24,\r\n                \"color\": \"#FFFFFF\",\r\n                \"align\": 'center'\r\n            });\r\n            this.starScoreTxt.setOrigin(0.5, 0.5);\r\n\r\n            this.add([\r\n                this._bgComplete,\r\n                _CollectedPoints,\r\n                this._cup,\r\n                this._btnBack,\r\n                this._btnReplay,\r\n                this._btnNext,\r\n                this.totalScoreTxt,\r\n                this.starScoreTxt\r\n            ]);\r\n\r\n            this._btnBack.setInteractive({cursor: 'pointer'});\r\n            this._btnBack.on('pointerup', ()=>{\r\n                onBack(this._btnBack);\r\n                // if (this.music) {\r\n                //     this.music.stop();\r\n                // }\r\n            });\r\n            setupButtonTextureBased(this._btnBack, 'btnBACK1', 'btnBACK2');\r\n            this._btnReplay.setInteractive({cursor: 'pointer'});\r\n            this._btnReplay.once('pointerup', ()=>{\r\n                onReplay(this._btnReplay);\r\n                if (this.music) {\r\n                    this.music.stop();\r\n                }\r\n            });\r\n            setupButtonTextureBased(this._btnReplay, 'btnReplay1', 'btnReplay2');\r\n            this._btnNext.setInteractive({cursor: 'pointer'});\r\n            this._btnNext.on('pointerup', ()=>{\r\n                onNext(this._btnNext);\r\n                // if (this.music) {\r\n                //     this.music.stop();\r\n                // }\r\n            });\r\n            setupButtonTextureBased(this._btnNext, 'btnNEXT1', 'btnNEXT2');\r\n        }\r\n\r\n        private music = null;\r\n        public show(score:number, starScore:number):void {\r\n            this._cup.scale = 1.25;\r\n            this.scene.tweens.add({\r\n                targets: this._cup,\r\n                \"scale\": 1,\r\n                duration: 500,\r\n                ease: Phaser.Math.Easing.Back.Out\r\n            });\r\n\r\n            this.totalScoreTxt.text = String(score);\r\n            this.starScoreTxt.text = String(starScore);\r\n\r\n            // let music = this.scene.sound.add(\"viktory\");\r\n            this.music = this.scene.sound.add(\"Activity completion fantastic\");\r\n            this.music.play();\r\n        }\r\n    }\r\n}","namespace ctb.screen {\r\n\r\n    import Gameplay = ctb.core.Gameplay;\r\n    import Preloader = ctb.scene.Preloader;\r\n\r\n    export class GameplayScreen extends Phaser.GameObjects.Container {\r\n        _gameStage: Phaser.GameObjects.Image;\r\n        _btnClose: Phaser.GameObjects.Image;\r\n\r\n        private gameplayContainer: Phaser.GameObjects.Container;\r\n\r\n        gameplay: Gameplay;\r\n\r\n        _btnSound: Phaser.GameObjects.Image;\r\n\r\n        selectableLetters:Phaser.GameObjects.Container[];\r\n        targetBlocks:object[];\r\n\r\n        private bgMusic:any = null;\r\n\r\n        private character:Phaser.GameObjects.Sprite;\r\n\r\n        tallyEmptyArray: Phaser.GameObjects.Image[];\r\n        tally: Phaser.GameObjects.Image[];\r\n\r\n        longIce:Phaser.GameObjects.Image;\r\n\r\n        constructor(scene: Phaser.Scene, gameplay: Gameplay) {\r\n            super(scene);\r\n            this.gameplay = gameplay;window[\"gs\"]=this;\r\n\r\n            this._gameStage = new Phaser.GameObjects.Image(this.scene, game.scale.width / 2, game.scale.height / 2, 'BG');\r\n            this._gameStage.setOrigin(0.5, 0.5);\r\n            this._gameStage.setScale(1.02);\r\n            // this._gameStage.setInteractive();\r\n            this.add(this._gameStage);\r\n\r\n            this._btnClose = new Phaser.GameObjects.Image(this.scene, 1025-105, 100-50,'x Button');\r\n            this._btnClose.setInteractive({cursor: 'pointer'});\r\n            this._btnClose[\"defScale\"] = this._btnClose.scale;\r\n            setupButtonTextureBased(this._btnClose, 'x Button','x Button HOVER EFFECT');\r\n            this.add(this._btnClose);\r\n            this._btnClose.on('pointerup', () => {\r\n                playBtnClickAnim(this._btnClose);\r\n\r\n                this.onCloseClick();\r\n            });\r\n            this._btnSound = new Phaser.GameObjects.Image(this.scene, 160-105, 100-50, 'Sound');\r\n            this._btnSound.setInteractive({cursor: 'pointer'});\r\n            this._btnSound[\"defScale\"] = this._btnSound.scale;\r\n            setupButtonTextureBased(this._btnSound, 'Sound','Sound HOVER EFFECT');\r\n            this.add(this._btnSound);\r\n            this._btnSound.on('pointerup', () => {\r\n                playBtnClickAnim(this._btnSound);\r\n\r\n                this.onSoundClick();\r\n            });\r\n        }\r\n\r\n\r\n        private correctAudio = null;\r\n        private correctAudioWord = null;\r\n        private playCorrectAudio():void {\r\n            if (this.correctAudio) {\r\n                this.correctAudio.stop();\r\n            }\r\n            this.correctAudio = this.scene.sound.add('Make the word map');\r\n            this.correctAudio.play();\r\n            if (this.areYouSureWindow && this.areYouSureWindow.parentContainer == this) {\r\n                this.correctAudio.pause();\r\n            }\r\n\r\n            if (this.correctAudioWord) this.correctAudioWord.stop();\r\n        }\r\n\r\n        public onSoundClick(): void {\r\n            this.playCorrectAudio();\r\n        }\r\n\r\n        private idleDelayedCall = null;\r\n        private playIdle:()=>void = ()=>{\r\n            this.character.setOrigin(0.5, 0.5);\r\n            Preloader.playAnim('idle', this.character, ()=>{\r\n                this.idleDelayedCall = delayedCall(5000, ()=>{\r\n                    this.playIdle();\r\n                });\r\n            });\r\n        };\r\n\r\n        public showGameplay(): void {\r\n            setPageBackground(\"bg-australia\");\r\n\r\n            this.bgMusic = this.scene.sound.add(\"Winter bg sound\");\r\n            this.bgMusic.play();\r\n            this.bgMusic.loop = true;\r\n\r\n            this.gameplayContainer = new Phaser.GameObjects.Container(this.scene);\r\n            this.add(this.gameplayContainer);\r\n\r\n            this.gameplay.reset();\r\n\r\n            this.prepareRound();\r\n            this.gameplay.setupCallbacks(this.showCompleteWindow, this.showLoseWindow, ()=>{\r\n                this.onNewRound(true);\r\n            });\r\n\r\n            this.createTallies();\r\n        }\r\n\r\n        public prepareRound():void {\r\n            delayedCall(500, ()=>this.playCorrectAudio());\r\n\r\n            this.gameplayContainer.removeAll();\r\n\r\n            this.character = this.scene.add.sprite(0, 0, null);\r\n            this.character.setPosition(750, 310);\r\n            this.playIdle();\r\n\r\n            this.longIce = new Phaser.GameObjects.Image(this.scene, 110, 147, 'Long Ice');\r\n            this.longIce.setOrigin(0, 0);\r\n            this.longIce.alpha = 0;\r\n            this.gameplayContainer.add(this.longIce);\r\n\r\n            let randomizedLetter:string[] = Phaser.Utils.Array.Shuffle(this.gameplay.blockLetters.slice());\r\n\r\n            if (this.gameplay.useImages) {\r\n                let correctWord = new Phaser.GameObjects.Image(this.scene, 750, 180, this.gameplay.correctWord);\r\n                this.gameplayContainer.add(correctWord);\r\n            } else {\r\n                let correctWord:Phaser.GameObjects.Text = this.scene.add.text(750, 180, \"\", {\r\n                    \"fontFamily\": \"Quran Era font\",\r\n                    \"fontSize\": 90 as any,\r\n                    \"color\": \"#000000\",\r\n                    \"align\": 'center'\r\n                });\r\n                correctWord.setOrigin(0.5, 0.5);\r\n                correctWord.style.fixedHeight = 140;\r\n                correctWord.setText(this.gameplay.correctWord);\r\n                this.gameplayContainer.add(correctWord);\r\n            }\r\n\r\n\r\n            this.selectableLetters = [];\r\n            this.targetBlocks = [];\r\n            for (let i:number = 0; i < this.gameplay.getCorrectWordLettersNumber(); i++) {\r\n                let b = {\r\n                    x:174 + i * 133, y:215\r\n                };\r\n                b['alreadyFilled'] = false;\r\n                this.targetBlocks.push(b);\r\n                b[\"-letter-text\"] = this.gameplay.getCorrectWordCharAt(i);\r\n                b[\"-block-\"] = null;\r\n            }\r\n            for (let i:number = 0; i < randomizedLetter.length; i++) {\r\n                let a:Phaser.GameObjects.Container = new Phaser.GameObjects.Container(this.scene, 100 + i * 150, 525);\r\n                a.add(a[\"-image-\"] = new Phaser.GameObjects.Image(this.scene, 0, 0,'IceBlock'));\r\n                a[\"-image-\"].setOrigin(0.5, 0.5);\r\n                this.selectableLetters.push(a);\r\n\r\n                let txt:Phaser.GameObjects.Text | Phaser.GameObjects.Image;\r\n                if (this.gameplay.useImages) {\r\n                    txt = new Phaser.GameObjects.Image(this.scene, 0, 0, randomizedLetter[i]);\r\n                    a.add(txt);\r\n                } else {\r\n                    txt = this.scene.add.text(0, 0, \"\", {\r\n                        \"fontFamily\": \"Quran Era font\",\r\n                        \"fontSize\": 55 as any,\r\n                        \"color\": \"#000000\",\r\n                        \"align\": 'center'\r\n                    });\r\n                    txt.setOrigin(0.5, 0.5);\r\n                    txt.style.fixedHeight = 75;\r\n                    txt.setText(randomizedLetter[i]);\r\n                    a.add(txt);\r\n                }\r\n                a['startPosition'] = {x:a.x, y:a.y};\r\n\r\n                a[\"-letter-\"] = txt;\r\n                a[\"-letter-text\"] = randomizedLetter[i];\r\n                this.gameplayContainer.add(a);\r\n                a['-draggable-'] = true;\r\n            }\r\n\r\n            for (let a of this.selectableLetters) {\r\n                a.setSize(a[\"-image-\"].width, a[\"-image-\"].height);\r\n                a.setInteractive({cursor: 'pointer'});\r\n                this.scene.input.setDraggable(a);\r\n\r\n                a.on('pointerdown', () => {\r\n                    a['-pointerdown-'] = true;\r\n                    if (a['-draggable-']) this.scene.sound.add(\"drag from its spot\").play();\r\n                });\r\n                a.on('pointerup', () => {\r\n                    a['-pointerdown-'] = false;\r\n                    if (!a['-draggable-']) return;\r\n                    this.moveBridgeBackToStartPosition(a, null, true);\r\n                });\r\n                a.on('pointerout', () => {\r\n                    if (!a['-draggable-']) return;\r\n                    if (!a['-pointerdown-']) return;\r\n                    this.moveBridgeBackToStartPosition(a, null, true);\r\n                });\r\n            }\r\n\r\n            this.createInput();\r\n            this.setInputEnabled(false);\r\n\r\n            // delayedCall(1200, ()=>{\r\n\r\n            if (this.gameplay.isNewRound()) {\r\n                if (!this.gameplay.isRoundsComplete()) {\r\n                    // delayedCall(2000, ()=>{\r\n                    this.setInputEnabled(true);\r\n                    // });\r\n                }\r\n            } else {\r\n                this.setInputEnabled(true);\r\n            }\r\n            // });\r\n\r\n            this.gameplayContainer.add(this.character);\r\n        }\r\n\r\n        public _update() {\r\n            if (this.selectableLetters) {\r\n                for (let a of this.selectableLetters) {\r\n                    if (a.x < 0 + a[\"-image-\"].width/2) {\r\n                        a.x = 0 + a[\"-image-\"].width/2;\r\n                    } else if (a.x > game.scale.width - a[\"-image-\"].width/2) {\r\n                        a.x = game.scale.width - a[\"-image-\"].width/2;\r\n                    }\r\n                    if (a.y < 0 + a[\"-image-\"].height/2) {\r\n                        a.y = a[\"-image-\"].height/2;\r\n                    } else if (a.y > game.scale.height - a[\"-image-\"].height/2) {\r\n                        a.y = game.scale.height - a[\"-image-\"].height/2;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        public placeAppleOverBuckets(a):void {\r\n            if (!a.parentContainer) return;\r\n            this.gameplayContainer.remove(a);\r\n            this.gameplayContainer.addAt(a, this.gameplayContainer.length);\r\n        }\r\n\r\n        private onNewRound(showOut:boolean):void {\r\n            this.scene.sound.add(\"next_round\").play();\r\n\r\n            this.setInputEnabled(false);\r\n\r\n            if (showOut) {\r\n                this.prepareRound();\r\n            }\r\n        }\r\n\r\n        public createInput(): void {\r\n            this.scene.input.on('drag', (pointer, block, dragX, dragY) => {\r\n                if (!block['-draggable-']) return;\r\n\r\n                block.x = dragX;\r\n                block.y = dragY;\r\n                this.gameplayContainer.bringToTop(block);\r\n\r\n                let targetBlock:any;\r\n                for (targetBlock of this.targetBlocks) {\r\n                    if (targetBlock['alreadyFilled']) continue;\r\n\r\n                    if (Math.abs(block.x - targetBlock.x) < 25 && Math.abs(block.y - targetBlock.y) < 60 && (block.y > targetBlock.y - 7)) {\r\n                        block['-draggable-'] = false;\r\n\r\n                        targetBlock['alreadyFilled'] = true;\r\n\r\n                        this.scene.tweens.add({\r\n                            targets: block,\r\n                            x: targetBlock.x,\r\n                            y: targetBlock.y,\r\n                            duration: 300,\r\n                            ease: Phaser.Math.Easing.Back.Out\r\n                        });\r\n\r\n                        targetBlock[\"-block-\"] = block;\r\n\r\n                        this.checkTargetBlockLetters();\r\n                    }\r\n                }\r\n            });\r\n\r\n\r\n            this._btnClose.setInteractive({cursor: 'pointer', pixelPerfect:true});\r\n        }\r\n\r\n        private checkTargetBlockLetters():void {\r\n            let sameLettersNum:number = 0;\r\n            for (let targetBlock of this.targetBlocks) {\r\n                if (!targetBlock['-block-']) {\r\n                    this.scene.sound.add(\"Placing block above\").play();\r\n                    return;\r\n                }\r\n\r\n                if (targetBlock[\"-letter-text\"] == targetBlock['-block-'][\"-letter-text\"]) {\r\n                    sameLettersNum++;\r\n                }\r\n            }\r\n            this.setInputEnabled(false);\r\n            if (sameLettersNum == this.targetBlocks.length) {\r\n                this.scene.sound.add(\"Placing block above\").play();\r\n\r\n                this.scene.tweens.add({\r\n                    targets: this.longIce,\r\n                    alpha: 1,\r\n                    duration: 250,\r\n                    ease: Phaser.Math.Easing.Linear,\r\n                });\r\n\r\n                for (let targetBlock of this.targetBlocks) {\r\n                    this.scene.tweens.add({\r\n                        targets: targetBlock['-block-'][\"-image-\"],\r\n                        alpha: 0,\r\n                        duration: 250,\r\n                        ease: Phaser.Math.Easing.Linear\r\n                    });\r\n\r\n                    if (targetBlock == this.targetBlocks[1]) continue;\r\n\r\n                    this.scene.tweens.add({\r\n                        targets: targetBlock['-block-'],\r\n                        x: this.targetBlocks[1]['x'],\r\n                        duration: 250,\r\n                        alpha: 0,\r\n                        ease: Phaser.Math.Easing.Sine.Out,\r\n                        delay: 250\r\n                    });\r\n                    delayedCall(500, ()=>{\r\n                        if (this.gameplay.useImages) {\r\n                            (this.targetBlocks[1]['-block-'][\"-letter-\"] as Phaser.GameObjects.Image).setTexture(this.gameplay.correctWord);\r\n                        } else {\r\n                            (this.targetBlocks[1]['-block-'][\"-letter-\"] as Phaser.GameObjects.Text).setText(this.gameplay.correctWord);\r\n                        }\r\n                    });\r\n                }\r\n                this.scene.sound.add(\"Letters joining sound\").play();\r\n                delayedCall(250, ()=>this.scene.sound.add(\"Correct click\").play())\r\n                delayedCall(1000, ()=>this.scene.sound.add(\"success for corect word\").play());\r\n                this.onCorrectAnswer();\r\n            } else {\r\n\r\n                this.scene.sound.add(\"placed- wrong- snake - blocks go back\").play();\r\n\r\n                // this.scene.sound.add(\"Wrong attempt\").play();\r\n                delayedCall(2400, ()=>{\r\n                    for (let targetBlock of this.targetBlocks) {\r\n                        this.moveBridgeBackToStartPosition(targetBlock['-block-'], null, false);\r\n                    }\r\n                    // delayedCall(100, ()=>this.scene.sound.add(\"all three blocks move back after wrong\").play());\r\n                });\r\n\r\n                delayedCall(1500, ()=>{\r\n                    this.character.setOrigin(0.49, 0.515);\r\n                    Preloader.playAnim('yelling_wrong', this.character, ()=>{\r\n                        this.playIdle();\r\n                    });\r\n                    // this.scene.sound.add(\"Snake animation sfx\").play();\r\n                });\r\n\r\n                delayedCall(2500, ()=>{\r\n                    this.onWrongAnswer();\r\n\r\n                    for (let targetBlock of this.targetBlocks) {\r\n                        targetBlock['alreadyFilled'] = false;\r\n                        targetBlock['-block-']['-draggable-'] = true;\r\n                        targetBlock[\"-block-\"] = null;\r\n                    }\r\n                });\r\n\r\n                delayedCall(2750, ()=>{\r\n                    this.setInputEnabled(true);\r\n                });\r\n            }\r\n        }\r\n\r\n        private moveBridgeBackToStartPosition(block, onComplete, playSound):void {\r\n            this.scene.tweens.add({\r\n                targets: block,\r\n                x: block['startPosition'].x,\r\n                y: block['startPosition'].y,\r\n                duration: 350,\r\n                ease: Phaser.Math.Easing.Sine.Out,\r\n                onComplete:()=>{\r\n                    if (onComplete) onComplete();\r\n                }\r\n            });\r\n            if (Phaser.Math.Distance.Between(block['startPosition'].x, block['startPosition'].y, block.x, block.y) > 20) {\r\n                delayedCall(100, ()=>{\r\n                    if (playSound) {\r\n                        this.scene.sound.add(\"block goes back when released\").play();\r\n                    }\r\n                });\r\n\r\n            }\r\n\r\n            this.placeAppleOverBuckets(block);\r\n        }\r\n\r\n        public onCorrectAnswer(): boolean {\r\n            let i: number = this.gameplay.getCurrentTotalAnswersCount();\r\n            this.tallyEmptyArray[i].visible = false;\r\n            this.tally[i].visible = true;\r\n\r\n            let completed:boolean = this.gameplay.onCorrectAnswer();\r\n\r\n            return completed;\r\n        }\r\n\r\n        private soundWrongDrop = null;\r\n        public onWrongAnswer(): boolean {\r\n            let i: number = this.gameplay.getCurrentTotalAnswersCount();\r\n            this.tallyEmptyArray[i].visible = true;\r\n            this.tallyEmptyArray[i].visible = true;\r\n            this.tally[i].visible = false;\r\n\r\n            let lost:boolean = this.gameplay.onWrongAnswer();\r\n\r\n            // this.soundWrongDrop = this.scene.sound.add(\"wrong drop\");\r\n            // this.soundWrongDrop.play();\r\n            // this.scene.sound.add(\"Goose no\").play();\r\n\r\n            if (this.idleDelayedCall != null) {\r\n                destroyDelayedCall(this.idleDelayedCall);\r\n                this.idleDelayedCall = null;\r\n            }\r\n\r\n            if (!lost) {\r\n                delayedCall(650, ()=>this.playCorrectAudio());\r\n            }\r\n\r\n            return lost;\r\n        }\r\n\r\n        public onCloseClick(): void {\r\n            this.showAreYouSurePage();\r\n            this.scene.sound.add('warning page pop up sfx').play();\r\n        }\r\n\r\n        private createTallies(): void {\r\n            if (this.tally) {\r\n                for (let te of this.tallyEmptyArray) {\r\n                    te.visible = false;\r\n                    this.bringToTop(te);\r\n                }\r\n                for (let t of this.tally) {\r\n                    t.visible = false;\r\n                    this.bringToTop(t);\r\n                }\r\n                return;\r\n            }\r\n\r\n            let startX: number = 26;\r\n            let startY: number = 148;\r\n            let dy: number = 34;\r\n            let tallyEmptyArrayPositions = [];\r\n            for (let i = 0; i < 12; i++) {\r\n                tallyEmptyArrayPositions.push({x: startX, y: startY + i * dy});\r\n            }\r\n            this.tallyEmptyArray = [];\r\n            this.tally = [];\r\n\r\n            for (let p of tallyEmptyArrayPositions) {\r\n                let _BeehiveEmpty = new Phaser.GameObjects.Image(this.scene, p['x'], p['y'], 'tally Empty');\r\n                this.tallyEmptyArray.push(_BeehiveEmpty);\r\n                _BeehiveEmpty.visible = false;\r\n\r\n                let _Beehive = new Phaser.GameObjects.Image(this.scene, p['x'], p['y'], 'tally');\r\n                this.tally.push(_Beehive);\r\n            }\r\n\r\n            for (let bea of this.tallyEmptyArray) {\r\n                this.add(bea);\r\n            }\r\n            for (let bee of this.tally) {\r\n                this.add(bee);\r\n                bee.visible = false;\r\n            }\r\n        }\r\n\r\n        public hideAllUnusedTallies():void {\r\n            let i: number = this.gameplay.getCurrentTotalAnswersCount();\r\n            for (let k:number = i + 1; k < this.tallyEmptyArray.length; k++) {\r\n                this.tallyEmptyArray[k].visible = false;\r\n                this.tally[k].visible = false;\r\n            }\r\n        }\r\n\r\n        private wfsnd = null;\r\n        private instructionPage: InstructionPage;\r\n        public showInstructionPage(): void {\r\n            setPageBackground(\"bg-blue\");\r\n\r\n            let playInstructionSound:()=>void = ()=>{\r\n                if (this.wfsnd) {\r\n                    this.wfsnd.stop();\r\n                }\r\n                this.wfsnd = this.scene.sound.add(\"Drag the ice blocks to make the word\");\r\n                this.wfsnd.play();\r\n            };\r\n\r\n            this.instructionPage = new InstructionPage(this.scene, (target) => {\r\n                playBtnClickAnim(target);\r\n                this.instructionPage.destroy(true);\r\n                this.showGameplay();\r\n\r\n                if (this.wfsnd) {\r\n                    this.wfsnd.stop();\r\n                }\r\n            },(target) => {\r\n                playBtnClickAnim(target);\r\n                playInstructionSound();\r\n            });\r\n            this.add(this.instructionPage);\r\n            playInstructionSound();\r\n        }\r\n\r\n        private areYouSureWindow:AreYouSureWindow;\r\n        public showAreYouSurePage(): void {\r\n            pauseAllDelayedCalls();\r\n            setPageBackground(\"bg-blue\");\r\n            this.scene.tweens.pauseAll();\r\n\r\n            this.pauseSounds();\r\n\r\n            this.areYouSureWindow = new AreYouSureWindow(this.scene, ()=> {\r\n                this.scene.tweens.resumeAll();\r\n                this.areYouSureWindow.destroy(true);\r\n                this.destroyGameplay();\r\n                this.showInstructionPage();\r\n            },()=> {\r\n                this.scene.tweens.resumeAll();\r\n                this.areYouSureWindow.destroy(true);\r\n                this.unpauseSounds();\r\n                resumeAllDelayedCalls();\r\n                setPageBackground(\"bg-australia\");\r\n            });\r\n            this.add(this.areYouSureWindow);\r\n        }\r\n\r\n        public showCompleteWindow: (score: number, starScore: number) => void = (score: number, starScore: number) => {\r\n            let completeWindow: CompleteWindow = new CompleteWindow(this.scene, (target) => {\r\n                playBtnClickAnim(target);\r\n            }, (target) => {\r\n                playBtnClickAnim(target);\r\n                this.destroyGameplay();\r\n                completeWindow.destroy(true);\r\n                this.showInstructionPage();\r\n            }, (target) => {\r\n                playBtnClickAnim(target);\r\n            });\r\n            this.setInputEnabled(false);\r\n            delayedCall(2000, () => {\r\n                setPageBackground(\"bg-blue\");\r\n\r\n                this.add(completeWindow);\r\n                completeWindow.show(score, starScore);\r\n\r\n                this.bgMusic.stop();\r\n            });\r\n        };\r\n\r\n        public showLoseWindow: (score: number, starScore: number) => void = (score: number, starScore: number) => {\r\n            let tryAgainWindow: TryAgainWindow = new TryAgainWindow(this.scene, (target) => {\r\n                playBtnClickAnim(target);\r\n            }, (target) => {\r\n                playBtnClickAnim(target);\r\n                this.destroyGameplay();\r\n                tryAgainWindow.destroy(true);\r\n                this.showInstructionPage();\r\n            });\r\n            this.setInputEnabled(false);\r\n            delayedCall(1500, () => {\r\n                setPageBackground(\"bg-blue\");\r\n\r\n                this.add(tryAgainWindow);\r\n                tryAgainWindow.show(score, starScore);\r\n\r\n                this.bgMusic.stop();\r\n            });\r\n        };\r\n\r\n        public setInputEnabled(enabled: boolean): void {\r\n            if (enabled) {\r\n                for (let a of this.selectableLetters) a.setInteractive({cursor: 'pointer'});\r\n            } else {\r\n                for (let a of this.selectableLetters) a.disableInteractive();\r\n            }\r\n        }\r\n\r\n        public pauseSounds():void {\r\n            this.scene.sound.pauseAll();\r\n        }\r\n\r\n        public unpauseSounds():void {\r\n            this.scene.sound.resumeAll();\r\n        }\r\n\r\n        public destroyGameplay():void {\r\n            this.setInputEnabled(false);\r\n            this.remove(this.gameplayContainer);\r\n            this.scene.sound.stopAll();\r\n            destroyAllDelayedCalls();\r\n        }\r\n    }\r\n}","namespace ctb.screen {\r\n    export class InstructionPage extends Phaser.GameObjects.Container {\r\n\r\n        private _instructionPage: Phaser.GameObjects.Image;\r\n        private _instructionPageTitle: Phaser.GameObjects.Image;\r\n        private _btnPlay: Phaser.GameObjects.Image;\r\n        private _btnSoundInstruction: Phaser.GameObjects.Image;\r\n        private instrTxt: Phaser.GameObjects.Text;\r\n\r\n        constructor(scene: Phaser.Scene, onPlayClick:(target)=>void, onSndClick:(target)=>void) {\r\n            super(scene);\r\n\r\n            this._instructionPage = new Phaser.GameObjects.Image(this.scene, 0-105, 0-48, 'Instructions page  ALL ACTIVITY  TITLEs');\r\n            this._instructionPage.setOrigin(0, 0);\r\n            // this._instructionPage.setInteractive();\r\n\r\n            this._instructionPageTitle = new Phaser.GameObjects.Image(this.scene, 495, 105, 'Ice Blocks');\r\n            this._instructionPageTitle.setScale(0.75);\r\n\r\n            this._btnPlay = new Phaser.GameObjects.Image(this.scene, game.scale.width / 2, 480 - 50, 'btnPLAY1');\r\n            this._btnPlay.setInteractive({cursor: 'pointer'});\r\n            this._btnPlay.once('pointerup', onPlayClick);\r\n            setupButtonTextureBased(this._btnPlay, 'btnPLAY1', 'btnPLAY2');\r\n\r\n            this.instrTxt = this.scene.add.text(game.scale.width / 2, game.scale.height / 2, \"Drag the ice blocks to make the word.\", {\r\n                \"fontFamily\": \"Kids Rock Demo\",\r\n                \"fontSize\": 30,\r\n                \"color\": \"#43425D\",\r\n                \"align\": 'center'\r\n            });\r\n            this.instrTxt.setOrigin(0.5, 0.5);\r\n            this.instrTxt.setWordWrapWidth(600);\r\n            this.instrTxt.setLineSpacing(5);\r\n\r\n            this._btnSoundInstruction = new Phaser.GameObjects.Image(this.scene, 800 - 105, 156 - 50, 'Sound');\r\n            this._btnSoundInstruction.setInteractive({cursor: 'pointer'});\r\n            this._btnSoundInstruction.on('pointerup', onSndClick);\r\n            this._btnSoundInstruction[\"defScale\"] = this._btnSoundInstruction.scale;\r\n            setupButtonTextureBased(this._btnSoundInstruction, 'Sound','Sound HOVER EFFECT');\r\n\r\n            this.add(this._instructionPage);\r\n            this.add(this._instructionPageTitle);\r\n            this.add(this.instrTxt);\r\n            this.add(this._btnPlay);\r\n            this.add(this._btnSoundInstruction);\r\n        }\r\n    }\r\n}","namespace ctb.screen {\r\n    export class TryAgainWindow extends Phaser.GameObjects.Container {\r\n\r\n        _bg:Phaser.GameObjects.Image;\r\n        _star:Phaser.GameObjects.Image;\r\n        _btnBack:Phaser.GameObjects.Image;\r\n        _btnReplay:Phaser.GameObjects.Image;\r\n\r\n        totalScoreTxt:Phaser.GameObjects.Text;\r\n        starScoreTxt:Phaser.GameObjects.Text;\r\n\r\n        constructor(scene: Phaser.Scene, onBack:(target)=>void, onReplay:(target)=>void) {\r\n            super(scene);\r\n\r\n            this.setPosition(-106, -48);\r\n\r\n            this._bg = new Phaser.GameObjects.Image(this.scene, 0, 0, 'Try again page');\r\n            this._bg.setOrigin(0, 0);\r\n            // this._bg.setInteractive();\r\n            this._star = new Phaser.GameObjects.Image(this.scene, 400, 415, 'Break Star');\r\n            this._btnBack = new Phaser.GameObjects.Image(this.scene, 600, 580, 'btnBACK1');\r\n            this._btnReplay = new Phaser.GameObjects.Image(this.scene, 765, 580, 'btnReplay1');\r\n\r\n            this.totalScoreTxt = this.scene.add.text(830, 355, \"\", {\r\n                \"fontFamily\": \"Kids Rock Demo\",\r\n                \"fontSize\": 35,\r\n                \"color\": \"#F49F1C\",\r\n                \"align\": 'center',\r\n                'stroke': '#70451A',\r\n                'strokeThickness': 6\r\n            });\r\n            this.totalScoreTxt.setOrigin(0.5, 0.5);\r\n\r\n            let grd = this.totalScoreTxt.context.createLinearGradient(0, 0, 0, this.totalScoreTxt.height);\r\n            grd.addColorStop(0, '#FFFF00');\r\n            grd.addColorStop(1, '#C17316');\r\n            this.totalScoreTxt.setFill(grd);\r\n\r\n            this.starScoreTxt = this.scene.add.text(635, 431, \"\", {\r\n                \"fontFamily\": \"Kids Rock Demo\",\r\n                \"fontSize\": 24,\r\n                \"color\": \"#FFFFFF\",\r\n                \"align\": 'center'\r\n            });\r\n            this.starScoreTxt.setOrigin(0.5, 0.5);\r\n\r\n            this.add([\r\n                this._bg,\r\n                this._star,\r\n                this._btnBack,\r\n                this._btnReplay,\r\n                this.totalScoreTxt,\r\n                this.starScoreTxt\r\n            ]);\r\n\r\n            this._btnBack.setInteractive({cursor: 'pointer'});\r\n            this._btnBack.on('pointerup', ()=>{\r\n                onBack(this._btnBack);\r\n                // if (this.music) {\r\n                //     this.music.stop();\r\n                // }\r\n            });\r\n            setupButtonTextureBased(this._btnBack, 'btnBACK1', 'btnBACK2');\r\n            this._btnReplay.setInteractive({cursor: 'pointer'});\r\n            this._btnReplay.once('pointerup', ()=>{\r\n                onReplay(this._btnReplay);\r\n                if (this.music) {\r\n                    this.music.stop();\r\n                }\r\n            });\r\n            setupButtonTextureBased(this._btnReplay, 'btnReplay1', 'btnReplay2');\r\n        }\r\n\r\n        private music = null;\r\n        public show(score:number, starScore:number):void {\r\n            this._star.scale = 1.25;\r\n            this.scene.tweens.add({\r\n                targets: this._star,\r\n                \"scale\": 1,\r\n                duration: 500,\r\n                ease: Phaser.Math.Easing.Back.Out\r\n            });\r\n\r\n            this.totalScoreTxt.text = String(score);\r\n            this.starScoreTxt.text = String(starScore);\r\n\r\n            this.music = this.scene.sound.add(\"Fail - close one\");\r\n            this.music.play();\r\n        }\r\n    }\r\n}"]}